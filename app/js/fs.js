(function(){var z=this&&this.__extends||function(a,g){function e(){this.constructor=a}for(var b in g)g.hasOwnProperty(b)&&(a[b]=g[b]);a.prototype=null===g?Object.create(g):(e.prototype=g.prototype,new e)},m;(function(a){var g;a.Namespace=function(a){if(!g){var b=a._fs_loaded;g=b?b:a._fs_namespace?a._fs_namespace:"FS"}return g};a.isLoaded=function(a){return a._fs_loaded};a.setLoaded=function(a,b){a._fs_loaded=b;b in a||(a[b]={})}})(m||(m={}));(function(a){a._fs_debug=function(a){return!!a._fs_ext_debug||
!!a._fs_debug};a._fs_host=function(a){return a._fs_ext_host||a._fs_host};a._fs_org=function(a){return a._fs_ext_org||a._fs_org};a._fs_csp=function(a){return a._fs_csp};a._fs_cookie_domain=function(a){return a._fs_cookie_domain};a._fs_ready=function(a){return a._fs_ready};a._fs_run_in_iframe=function(a){return!!a._fs_run_in_iframe};a._fs_is_outer_script=function(a){return!!a._fs_is_outer_script};a._fs_replay_flags=function(a){return a._fs_replay_flags};a._fs_transport=function(a){return a._fs_transport};
a.set_fs_shutdown=function(a,e){a._fs_shutdown=e};a.FS_q_drain=function(g){if((g=g[a.Namespace(g)])&&"q"in g){var e=g.q;delete g.q;return e}return[]};a.FS_q_push=function(g,e){var b=g[a.Namespace(g)];"q"in b||(b.q=[]);b.q.push(e)}})(m||(m={}));(function(a){a.windex=window;var g;a.initWindex=function(e){if(e.document&&e.document.head){if(g)try{a.windex.JSON.stringify(0);return}catch(b){}var d=e.document.head,c=e.document.createElement("iframe");c.id="FullStory-iframe";c.className="fs-hide";c.setAttribute("style",
"display: none;");d.appendChild(c);c.src="about:blank";g=c;a.windex=g.contentWindow;e.document.head.removeChild(g);try{a.windex.JSON.stringify(0)}catch(f){a.windex=e}}}})(m||(m={}));(function(a){function g(a){f&&window.console&&console.log(a)}function e(b,c){var d=0;try{a.windex.JSON.stringify(b,function(a,b){if(d++>c)throw"break";return"object"!=typeof b?void 0:b})}catch(k){if("break"!=k)return!0}return!1}function b(c,k,h,f){if(1>k)return 0;var l;c&&c.constructor==Date?l=isNaN(c)?"Invalid Date":
c.toUTCString():(l="object"===typeof Node?c instanceof Node:c&&"object"===typeof c&&0<c.nodeType&&"string"===typeof c.nodeName,l=l?d(c):void 0===c?"undefined":"object"!=typeof c||null==c?c:c instanceof Error?c.stack||c.name+": "+c.message:void 0);if(void 0!==l){l=a.windex.JSON.stringify(l);if(void 0===l)return 0;'"'==l[0]&&(l=t(l,k,'..."'));return l.length<=k?(f.tokens.push(l),l.length):0}if(f.catchCycles){f.opath.splice(h);l=f.opath.lastIndexOf(c);if(-1<l)return c='"'+t("<Cycle to ancestor #"+(h-
l-1)+">",k-2)+'"',f.tokens.push(c),c.length;f.opath.push(c)}var e=k,n=function(a){return e>=a.length?(e-=a.length,f.tokens.push(a),!0):!1};l=function(a){","==f.tokens[f.tokens.length-1]?f.tokens[f.tokens.length-1]=a:n(a)};if(2>e)return 0;if(a.isArray(c)){n("[");for(var g=0;g<c.length&&0<e;g++){var x=b(c[g],e-1,h+1,f),e=e-x;if(0==x&&!n("null"))break;n(",")}l("]")}else{n("{");for(var A=Object.keys(c),g=0;g<A.length&&0<e;g++){var x=A[g],m=c[x];if(!n('"'+x+'":'))break;x=b(m,e-1,h+1,f);if(0==x){f.tokens.pop();
break}e-=x;n(",")}l("}")}return Infinity==k?1:k-e}function d(a){if(a.tagName){var b=c(a);return"<"+b+(a.attributes&&a.attributes.type?' type="'+a.attributes.type.value+'"':"")+(a.id?' id="'+a.id+'"':"")+(a.className?' class="'+a.className+'"':"")+">...</"+b+">"}b="";a.data&&a.data.substring&&(b=" "+a.data.substring(0,50)+(50<a.data.length?"...":""));return a.nodeName+b}function c(a){return"object"==typeof a.tagName?"form":a.tagName.toLowerCase()}var f=!1;a.bind=Function.prototype.bind?function(a,
b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];return a.bind.apply(a,[b].concat(c))}:function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];return function(){var d=Array.prototype.slice.call(arguments);a.call.apply(a,[b].concat(c,d))}};a._native_filter=function(a,b,c){return a.filter(b,c)};a._js_filter=function(a,b,c){for(var d=Array(a.length),k=0;k<a.length;k++)d[k]=b.call(c,a[k],k,a);return d};a.filter=Array.prototype.filter?a._native_filter:a._js_filter;var k=
function(b){return a.windex.Array.isArray(b)},h=function(b){return"[object Array]"==a.windex.Object.prototype.toString.call(b)};a.isArray=a.windex.Array.isArray?k:h;a.firstKey=function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return b};a.firstValue=function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return a[b]};a.hasNKeys=function(a,b){var c=0,d;for(d in a)if(Object.prototype.hasOwnProperty.call(a,d)&&++c>b)return!1;return c==b};a.hasMoreThanNKeys=function(a,
b){var c=0,d;for(d in a)if(Object.prototype.hasOwnProperty.call(a,d)&&++c>b)return!0;return!1};a.$entry=function(a,b){return a&&a.apply?function(){try{return a.apply(b||this,arguments)}catch(c){}}:a};a.initDebug=function(b){f=a._fs_debug(b)};a.isDebug=function(){return f};a.logIfDebug=g;a.logFSError=function(a){};a.stringify=function(a,c,d){void 0===c&&(c=Infinity);void 0===d&&(d=!0);try{var k={tokens:[],opath:[],catchCycles:d&&e(a,c/4)};b(a,c,0,k);return k.tokens.join("")}catch(f){a="Internal error: unable to determine what JSON error was";
try{a=""+f,a=a.replace(/[^a-zA-Z0-9\.\:\!\, ]/g,"_")}catch(h){}return'"'+a+'"'}};var t=function(a,b,c){void 0===c&&(c="...");return a.length<=b?a:a.length<=c.length||b<=c.length?a.substring(0,b):a.substring(0,b-c.length)+c};a.baseUri=function(a){return"baseURI"in a?a.baseURI:(a=a.getElementsByTagName("base")[0])&&a.href?a.href:location.href};a.doctypeString=function(a){a=a.doctype;if(!a)return null;var b;b="<!DOCTYPE "+a.name;a.publicId&&(b+=' PUBLIC "'+a.publicId+'"');a.systemId&&(b+=' "'+a.systemId+
'"');return b+">"};a.parseJson=function(b){return a.windex.JSON.parse(b)};a.domainFromHost=function(a){var b=a.indexOf(":");0<=b&&(a=a.slice(0,b));return a};a.isLocalhost=function(a){return"localhost"==a||"127.0.0.1"==a};a.tryGetScreenDims=function(a){var b=0,c=0;if(null==a.screen)return[b,c];b=parseInt(String(a.screen.width));c=parseInt(String(a.screen.height));b=isNaN(b)?0:b;c=isNaN(c)?0:c;return[b,c]};k=function(){function a(){this._listeners=[];this._yesCapture=!0;this._noCapture=!1;try{var b=
Object.defineProperty({},"passive",{get:function(){this._yesCapture={capture:!0,passive:!0};this._noCapture={capture:!1,passive:!0}}});window.addEventListener("test",null,b)}catch(c){}}a.prototype.add=function(a,b,c,d){c={target:a,type:b,fn:function(a){d(a)},options:c?this._yesCapture:this._noCapture,index:this._listeners.length};this._listeners.push(c);a.addEventListener(b,c.fn,c.options);return c};a.prototype.remove=function(a){a.target.removeEventListener(a.type,a.fn,a.options);a.target=null;a.fn=
null};a.prototype.clear=function(){for(var a=0;a<this._listeners.length;a++)this._listeners[a].target&&this.remove(this._listeners[a]);this._listeners=[]};return a}();a.DomListeners=k;var l=function(){function a(b,c){this.name=b;this._native=c;this.on=!0}a.prototype.before=function(a){this._before=a;return this};a.prototype.afterAsync=function(a){this._afterAsync=a;return this};a.prototype.afterSync=function(a){this._afterSync=a;return this};a.prototype.disable=function(){this.on=!1};a.prototype.enable=
function(){this.on=!0};a.prototype.getShim=function(){this.shim||this.setupShim();return this.shim};a.prototype.setupShim=function(){var a=this;this.shim=function(){var b={that:this,args:arguments};if(a.on)try{a._before&&a._before.call(this,b)}catch(c){g("Error in hook before "+a.name)}var d=a._native.apply(this,arguments);if(a.on)try{if(a._afterSync&&a._afterSync.call(this,b),a._afterAsync){var k=this;setTimeout(function(){try{a._afterAsync.call(k,b)}catch(c){g("Error in async hook after "+a.name)}})}}catch(f){g("Error in hook after "+
a.name)}return d}};return a}(),n={};a.activateHook=function(a,b){n[b]=n[b]||[];for(var c,d=0;d<n[b].length;d++)n[b][d].obj==a&&(c=n[b][d].hook);c||(c=new l(b,a[b]),n[b].push({obj:a,hook:c}),a[b]=c.getShim());c.enable();return c};a.tagName=c})(m||(m={}));(function(a){a.EVENT_MUT_INSERT=2;a.EVENT_MUT_REMOVE=3;a.EVENT_MUT_ATTR=4;a.EVENT_MUT_ATTR_CURVE=5;a.EVENT_MUT_TEXT=6;a.EVENT_MUT_SKIPIDS=7;a.EVENT_MOUSEMOVE=8;a.EVENT_MOUSEMOVE_CURVE=9;a.EVENT_SCROLL=10;a.EVENT_SCROLL_CURVE=11;a.EVENT_MOUSEDOWN=12;
a.EVENT_MOUSEUP=13;a.EVENT_KEYDOWN=14;a.EVENT_KEYUP=15;a.EVENT_CLICK=16;a.EVENT_FOCUS=17;a.EVENT_VALUECHANGE=18;a.EVENT_RESIZE=19;a.EVENT_DOMLOADED=20;a.EVENT_LOAD=21;a.EVENT_PLACEHOLDER_SIZE=22;a.EVENT_UNLOAD=23;a.EVENT_BLUR=24;a.EVENT_SET_FRAME_BASE=25;a.EVENT_TOUCHSTART=32;a.EVENT_TOUCHEND=33;a.EVENT_TOUCHCANCEL=34;a.EVENT_TOUCHMOVE=35;a.EVENT_TOUCHMOVE_CURVE=36;a.EVENT_NAVIGATE=37;a.EVENT_PLAY=38;a.EVENT_PAUSE=39;a.EVENT_INNERWIDTH=40;a.EVENT_INNERWIDTH_CURVE=41;a.EVENT_LOG=48;a.EVENT_ERROR=49;
a.EVENT_DBL_CLICK=50;a.EVENT_FORM_SUBMIT=51;a.EVENT_WINDOW_FOCUS=52;a.EVENT_WINDOW_BLUR=53;a.EVENT_HEARTBEAT=54;a.NAVIGATION_TIMING=55;a.EVENT_SYS_SETMETA=8192;a.EVENT_SYS_SETVAR=8193;a.EVENT_SYS_HIGHLIGHT=8194;a.EVENT_COOKED_LOAD="load";a.EVENT_COOKED_UNLOAD="unload";a.EVENT_COOKED_NAVIGATE="navigate";a.EVENT_COOKED_CLICK="click";a.EVENT_COOKED_TAP="tap";a.EVENT_COOKED_FOCUS="focus";a.EVENT_COOKED_CHANGE="change";a.EVENT_COOKED_MOUSE_THRASH="thrash";a.EVENT_FORM_ABANDONED="abandon";a.isUserActionEvent=
function(g){switch(g){case a.EVENT_MOUSEDOWN:case a.EVENT_MOUSEMOVE:case a.EVENT_MOUSEMOVE_CURVE:case a.EVENT_MOUSEUP:case a.EVENT_KEYDOWN:case a.EVENT_KEYUP:case a.EVENT_TOUCHSTART:case a.EVENT_TOUCHEND:case a.EVENT_TOUCHMOVE:case a.EVENT_TOUCHMOVE_CURVE:case a.EVENT_TOUCHCANCEL:case a.EVENT_CLICK:case a.EVENT_SCROLL:case a.EVENT_SCROLL_CURVE:case a.EVENT_NAVIGATE:return!0}return!1};a.MAX_LOGS_PER_PAGE=1024})(m||(m={}));(function(a){a.HighlightTypeFsId="fsidentity";a.HighlightTypeNewUid="newuid";
a.UID_COOKIE="fs_uid";a.BAD_APP_IDS=" 0 1 -1 n/a nan undefined null nil the_id_that_you_use_in_your_app_for_this_user".split(" ");var g=function(){function e(a){void 0===a&&(a=document);this._doc=a;this._cookie=null;this._cookies={}}e.prototype.initFromCookies=function(b,d){for(var c=this._doc.cookie.split(";"),f=0;f<c.length;f++){var k=c[f].replace(/^\s+|\s+$/g,"").split("="),h=k[0];this._cookies[h]||(this._cookies[h]=k[1])}var t=this._cookies[a.UID_COOKIE],l=h=k=f=c="";if(t){var e=t.split("`");
3>e.length?c=t:(k=e[0],h=e[1],c=e[2],5<=e.length&&(l=decodeURIComponent(e[3]),0<=a.BAD_APP_IDS.indexOf(l)&&(a.logIfDebug('ignoring invalid app key "'+l+'" from cookie.'),l="")))}t=c.indexOf(":");-1!=t&&(f=c.slice(t+1),c=c.slice(0,t));this._cookie={Host:k,OrgId:h,UserId:c,SessionId:f,AppKey:l};if(this._cookie.Host!=b||this._cookie.OrgId!=d)this._cookie={Host:b,OrgId:d,UserId:"",SessionId:"",AppKey:""}};e.prototype.initFromParsedCookie=function(a){this._cookie=a};e.prototype.clear=function(){var a=
this.host(),d=this.orgId();this._cookie={Host:a,OrgId:d,UserId:"",SessionId:"",AppKey:""};this.write()};e.prototype.host=function(){return this._cookie.Host};e.prototype.orgId=function(){return this._cookie.OrgId};e.prototype.userId=function(){return this._cookie.UserId};e.prototype.sessionId=function(){return this._cookie.SessionId};e.prototype.appKey=function(){return this._cookie.AppKey};e.prototype.cookieData=function(){return this._cookie};e.prototype.cookies=function(){return this._cookies};
e.prototype.setCookie=function(a,d){var c=a+"="+d,c=this._domain?c+("; domain=."+encodeURIComponent(this._domain)):c+"; domain=";this._doc.cookie=c+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"};e.prototype.setIds=function(b,d,c,f){a.isLocalhost(d)&&(d="");b=a._fs_cookie_domain(b);"string"==typeof b&&(d=b);this._domain=d;this._cookie.UserId=c;this._cookie.SessionId=f;this.write()};e.prototype.clearAppId=function(){if(!this._cookie.AppKey)return!1;this._cookie.AppKey="";this.write();return!0};
e.prototype.setAppId=function(b){"number"==typeof b&&b===b>>0&&(b=""+b);if("string"!=typeof b)return a.logIfDebug("blocking FS.identify API call; uid value ("+b+") must be a string"),[!1,a.HighlightTypeFsId];var d=b.trim();if(0<=a.BAD_APP_IDS.indexOf(d.toLowerCase()))return a.logIfDebug("blocking FS.identify API call; uid value ("+b+") is illegal"),[!1,a.HighlightTypeFsId];b=void 0;this._cookie.AppKey&&this._cookie.AppKey!=d&&(a.logIfDebug("user re-identified; existing uid ("+this._cookie.AppKey+
") does not match provided uid ("+d+")"),b=a.HighlightTypeNewUid);this._cookie.AppKey=d;this.write();return[!0,b]};e.prototype.encode=function(){var a=this._cookie.Host+"`"+this._cookie.OrgId+"`"+this._cookie.UserId+":"+this._cookie.SessionId;this._cookie.AppKey&&(a+="`"+encodeURIComponent(this._cookie.AppKey)+"`");return a};e.prototype.write=function(){null!=this._domain&&this.setCookie(a.UID_COOKIE,this.encode())};return e}();a.Identity=g})(m||(m={}));(function(a){var g=function(){function e(a){this._identity=
a;this.AccountSystemVars={acctId:"str",displayName:"str",website:"str"};this.UserSystemVars={uid:"str",displayName:"str",email:"str"};this.VarTypes={str:function(a){return"string"==typeof a},bool:function(a){return"boolean"==typeof a},"int":function(a){return"number"==typeof a&&0==a-Math.floor(a)},real:function(a){return"number"==typeof a},date:function(a){return a?!isNaN(a.constructor===Date?a:new Date(a)):!1}}}e.prototype.identity=function(){return this._identity};e.prototype.api=function(b,d){var c=
!1,f=[];switch(b){case "account":f=f.concat(this.setvar_api("acct",this.AccountSystemVars,d));break;case "user":if("uid"in d){var k=d.uid;if(!1===k)this._identity.clearAppId()&&(c=!0),delete d.uid;else{var k=this._identity.setAppId(k),h=k[1];if(!k[0]){switch(h){case a.HighlightTypeFsId:f.push({When:0,Kind:a.EVENT_SYS_HIGHLIGHT,Args:[a.HighlightTypeFsId,d.uid+""]});break;case void 0:break;default:a.logIfDebug("unexpected failReason returned from setAppId: "+h)}return[f,!1]}h==a.HighlightTypeNewUid&&
(c=!0)}}f=f.concat(this.setvar_api("user",this.UserSystemVars,d));break;default:a.logIfDebug('invalid operation "'+b+'"; only "account" and "user" are supported at present')}return[f,c]};e.prototype.setvar_api=function(b,d,c){var f=[],k={},h;for(h in c)if(c.hasOwnProperty(h)){var e=c[h];a.logIfDebug("set-var('"+b+"'): \""+h+'" = '+a.stringify(e));var l=typeof e;if("object"!==l||e&&e.constructor==Date){var n,g;if(h in d)n=h,g=d[h];else{g=h.split("_");if(2!=g.length){a.logIfDebug('variables must be of the form "name_type", where "type" is one of [str, bool, int, real, date]');
f.push({When:0,Kind:a.EVENT_SYS_HIGHLIGHT,Args:["varname",b+":"+h]});continue}-1!=h.indexOf(" ")?(n=h.replace(/ /g,""),f.push({When:0,Kind:a.EVENT_SYS_HIGHLIGHT,Args:["varname",b+":"+h]}),a.logIfDebug("Warning: variable '"+h+"' has spaces in it, which is disallowed. Converted name to '"+n+"'.")):n=h;g=g[1]}g in this.VarTypes?this.VarTypes[g](e)?("str"==g&&(e=e.trim()),"date"==g&&(e=this.toIsoString(e)),k[n]=e):(a.logIfDebug("illegal value "+a.stringify(e)+" for type "+g),"number"===l?l=0==e-Math.floor(e)?
"integer":"real":"object"==l&&(null!=e&&e.constructor==Date)&&(l=isNaN(e)?"invalid date":"date"),f.push({When:0,Kind:a.EVENT_SYS_HIGHLIGHT,Args:["vartype",b+":"+h,l]})):(a.logIfDebug('invalid type "'+g+'"'),f.push({When:0,Kind:a.EVENT_SYS_HIGHLIGHT,Args:["varname",b+":"+h]}))}else e instanceof Array&&(l="array"),f.push({When:0,Kind:a.EVENT_SYS_HIGHLIGHT,Args:["vartype",b+":"+h,l+" (unsupported)"]})}f.push({When:0,Kind:a.EVENT_SYS_SETVAR,Args:[b,a.stringify(k)]});return f};e.prototype.toIsoString=
function(a){return(a.constructor===Date?a:new Date(a)).toISOString()};return e}();a.Vars=g})(m||(m={}));var y;(function(a){var g=/(?:[^\\](?:\\\\)*)/.source;a.CSS_URL=RegExp('url\\(\\s*"(.*?'+g+")\"\\s*\\)|url\\(\\s*'(.*?"+g+")'\\s*\\)|url\\((.*?"+g+")\\)","g");a.QUOTES=/\"|'/g;a.HOVER=/\:hover/g;a.FOCUS=/\:focus/g;a.MEDIA_QUERY=/(@media.*?{)/g;a.DOMAIN=/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]{2,}$/;a.DOMAIN_PART=/^[a-zA-Z0-9-:]{1,61}$/;a.IPv4_PART=/^[0-9]{1,3}$/;a.IPv6_PART=/^[0-9a-f]{0,4}$/;
a.PLAYBACK_URL_PARAMS=/.*\?Base=(.*)&Url=(.*)/;a.EMAIL=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;a.IMAGE_FILENAME=/\.(jpe?g|png|svg|gif|bmp)$/;a.ATTR_SELECTOR=/\[.*\]/g;a.SVG_NS=/svg\:/g})(y||(y={}));(function(a){var g=function(){function a(b,c){this.parent=b;this.combinator=c;this.classes={};this.attrs={};this.attrMatch={}}a.prototype.cssEscapeIdent=function(a){var b=function(a){return-1!=
"[]:./\\()@#%^&*'\" ".indexOf(a)?"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "};return"-"==a?"\\-":"-"==a[0]?"-"+a.slice(1).replace(/([^0-9a-zA-Z-_])/g,b):a.replace(/[^0-9a-zA-Z-_:]/g,b)};a.prototype.cssEscapeString=function(a){return'"'+a.replace(/[\x01-\x1f\"\\]/g,function(a){return'"'==a||"\\"==a?"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "})+'"'};a.prototype.serialize=function(){var a=this.combinator?this.combinator:"";this.tag&&(a+="*"==this.tag?this.tag:this.cssEscapeIdent(this.tag));this.id&&
(a+="#"+this.cssEscapeIdent(this.id));var b=Object.keys(this.classes);b.sort();for(var f=0;f<b.length;f++)a+="."+this.cssEscapeIdent(b[f]);for(var k in this.attrs)a=""==this.attrMatch[k]?a+("["+this.cssEscapeIdent(k)+"]"):a+("["+this.cssEscapeIdent(k)+this.attrMatch[k]+this.cssEscapeString(this.attrs[k])+"]");return a};return a}();a.SelectorRule=g;var e=function(){function a(b){this.rules=b}a.parse=function(d,c,f){void 0===c&&(c=null);d=d.trim();var k=new g(null,null),h=0,e=!1,l=function(){throw"Invalid selector";
},n=function(){q=d[++h];if("\n"==q||null==q)throw l();if(q.match(/[0-9a-fA-F]/)){var a="";do a+=q,q=d[++h];while(q&&q.match(/[0-9a-fA-F]/));q&&q.match(/[\s]/)&&h++;return String.fromCharCode(parseInt(a,16))}h++;return q},r=function(a){for(var b=h,c="",k;null!=(k=d[h]);)if("\\"==k)c+=n();else if(k.match(a?/[a-zA-Z0-9_:\-]/:/[a-zA-Z0-9_\-]/)||128<k.charCodeAt(0))c+=k,h++;else break;if(b==h)throw l();return c},m=function(){for(;null!=d[h]&&d[h].match(/\s/);)h++},s=function(){e=!0;h++;var a=r().toLowerCase();
try{var b;m();var f=d[h],g="=";if("*"==f||"|"==f||"^"==f||"$"==f||"~"==f)g=f+"=",h++;if(c&&!c[g])throw l();if("="!=d[h])throw l();h++;m();b=g}catch(s){if(c&&!c["[]"]||"Invalid selector"!=s)throw s;if("]"!=d[h])throw l();h++;k.attrs[a]=k.attrMatch[a]="";return}q=d[h];'"'==q||"'"==q?(f=q,h++):f="]";for(g="";(q=d[h])!=f;){if(null==q)throw l();if("\\"==q)g+=n();else{if("]"==f&&('"'==q||"'"==q))throw l();g+=q;h++}}h++;"]"!=f&&"]"==d[h]&&h++;k.attrs[a]=g;k.attrMatch[a]=b},w=function(){if(!e)throw l();e=
!1;m();var a=d[h];">"==a||"+"==a||"~"==a?(h++,m()):a=" ";k=new g(k,a);if(c&&!c[a])throw l();};if(0==d.indexOf("//"))throw l();for(var v=0,h=0;h<d.length;){if(v++>2*d.length)throw console.log("Likely caught in an infinite loop while parsing "+d),"Internal error, infinite loop";var q=d[h];switch(q){case "#":e=!0;h++;k.id=r();break;case "*":if(e)throw l();e=!0;k.tag="*";if(c&&!c["*"])throw l();h++;break;case ".":e=!0;h++;k.classes[r()]=!0;break;case "[":s();break;case " ":case ">":case "+":case "~":w();
break;case ":":throw l();default:if(e)throw l();e=!0;k.tag=r(f).toLowerCase()}}if(!e)throw l();return new a(k)};a.prototype.serialize=function(){for(var a=null,b=this.rules;b;b=b.parent)a=a?b.serialize()+a:b.serialize();return a};return a}();a.Selector=e})(m||(m={}));(function(a){function g(a){var b={};if(!a)return b;if(a.classList)for(var d=0;d<a.classList.length;++d)b[a.classList[d]]=!0;else if(a.className)for(a=(a.getAttribute("class")||"").split(" "),d=0;d<a.length;++d)b[a[d].trim()]=!0;return b}
a.NYI_KIND="nyi";a.BLOCKED_KIND="blocked";a.HIDE_KIND="hide";var e=function(){function b(a,c){this._parent=a;this._rule=c}b.prototype.parent=function(){return this._parent};b.prototype.matches=function(d,k){if(!d||this._rule.tag&&a.tagName(d)!=this._rule.tag||this._rule.id&&d.id!=this._rule.id)return!1;for(var h in this._rule.classes)if(!(h in k))return!1;for(var e in this._rule.attrs)if(h=d.getAttribute(e),null==h||!b.attrPredicates[this._rule.attrMatch[e]](h,this._rule.attrs[e]))return!1;return this._parent?
this._parent.matches(d.parentElement,g(d.parentElement)):!0};return b}();e.attrPredicates={"":function(a,b){return!0},"=":function(a,b){return a==b},"*=":function(a,b){return-1<a.indexOf(b)},"^=":function(a,b){return 0==a.lastIndexOf(b,0)},"$=":function(a,b){return a.indexOf(b,a.length-b.length)+b.length==a.length},"~=":function(a,b){return-1<a.split(/\s+/).indexOf(b)},"|=":function(a,b){return-1<a.split("-").indexOf(b)}};a.BlockRuleElem=e;var b=function(){function b(c){this.kind=c.Kind;this.selector=
a.Selector.parse(c.Selector,{">":!0,"=":!0,"[]":!0,"*=":!0,"^=":!0,"$=":!0,"~=":!0,"|=":!0});var d=function(a){return new e(a.parent?d(a.parent):null,a)};this.rules=d(this.selector.rules)}b.isComment=function(a){return!!a.match(/^\s*\/\//)};b.prototype.serialize=function(){return this.selector.serialize()};return b}();a.BlockRule=b;var d=function(){function c(){this._rules=[];this._predicateRules=[];this.rawRules=[]}c.prototype.isBlocked=function(a){for(var b=0;b<this._predicateRules.length;++b)if(this._predicateRules[b].Selector(a))return this._predicateRules[b].Kind;
for(var c=g(a),b=0;b<this._rules.length;++b)if(this._rules[b].rules.matches(a,c))return this._rules[b].kind;return null};c.prototype.addRule=function(a){this._rules.push(new b(a));this.rawRules.push(a)};c.prototype.addPredicateRule=function(a){this._predicateRules.push(a)};c.prototype.mungeBlockedStyle=function(b,c){var d=b.getBoundingClientRect(),e=Math.floor(d.width),d=Math.floor(d.height);if("object"==a.tagName(b))for(var l=b.children,g=0;g<l.length;g++){var r=l[g];if("embed"==a.tagName(r)){l=
r.getBoundingClientRect();e=Math.max(e,Math.floor(l.width));d=Math.max(d,Math.floor(l.height));break}}l="";null!=c&&(l=c.trim());0<l.length&&";"!=l.charAt(l.length-1)&&(l+=";");if(0!=e||0!=d)l+="width:"+e+"px;height:"+d+"px;";return l};return c}();a.Blocker=d})(m||(m={}));(function(a){a.MutationProcessingInterval=250;a.CurveSamplingInterval=142;a.UploadInterval=5E3;a.UserInactivityTimeout=1E4;a.HeartbeatInitial=4E3;a.HeartbeatMax=256E3;a.PageInactivityTimeout=18E5;a.BackoffMax=3E5;a.ScrollSampleInterval=
a.MutationProcessingInterval/5;a.InactivityThreshold=4E3})(m||(m={}));(function(a){var g=function(){function a(b,c,f){this._ctx=b;this._q=c;this._valueIndices=f;this._evts=[]}a.prototype.add=function(a){0==this._evts.length&&this._q.push(a);this._evts.push(a)};a.prototype.finish=function(a,b){var f=this._evts.length;if(1>=f)return!1;for(var k=this._evts[0].When,h=this._evts[f-1].When,e=0;e<this._valueIndices.length;++e){var l=this._valueIndices[e],g=this._evts[0].Args[l],r=(this._evts[1].When-k)/
(h-k),m=(this._evts[1].Args[l]-g)/r,s=this._evts[f-1].Args[l],r=(h-this._evts[f-2].When)/(h-k);b.push(g,s,m,(s-this._evts[f-2].Args[l])/r)}this._evts[0].Kind=a;this._evts[0].Args=b;return!0};a.prototype.evts=function(){return this._evts};return a}(),e=function(){function b(a){this._ctx=a;this._gotInitialScroll=!1}b.prototype.processQueue=function(b){if(0==b.length)return b;this._ctx.maybeAddInitialScroll();for(var c=this._ctx.now(),f=[],k=new g(this._ctx,f,[0,1]),h={},e={},l,n=0;n<b.length;++n){var m=
b[n];switch(m.Kind){case a.EVENT_MOUSEMOVE:k.add(m);break;case a.EVENT_TOUCHMOVE:var p=m.Args[0];p in h||(h[p]=new g(this._ctx,f,[1,2]));h[p].add(m);break;case a.EVENT_SCROLL:p=m.Args[0];p in e||(e[p]=new g(this._ctx,f,[1,2]));e[p].add(m);break;case a.EVENT_INNERWIDTH:l||(l=new g(this._ctx,f,[0]));l.add(m);break;default:f.push(m)}}k.finish(a.EVENT_MOUSEMOVE_CURVE,[c])&&(b=k.evts(),k=b[b.length-1].Args,2<k.length&&k[2]&&b[0].Args.push(k[2]));for(p in e)b=parseInt(p),e[b].finish(a.EVENT_SCROLL_CURVE,
[c,b]);for(p in h)b=parseInt(p),h[b].finish(a.EVENT_TOUCHMOVE_CURVE,[c,b]);l&&l.finish(a.EVENT_INNERWIDTH_CURVE,[c]);return f};return b}();a.EventProcessor=e})(m||(m={}));(function(a){a.CompiledTimestamp=1499439693;a.CompiledVersion="UNSET"})(m||(m={}));(function(a){function g(){var k,h;try{throw Error("");}catch(f){k="<generated>\n",h=f.stack||f.backtrace||f.stacktrace}if(!h){k="<generated-ie>\n";h=[];try{for(var e=arguments.callee.caller.caller;e&&h.length<b;){var g=c.test(e.toString())?RegExp.$1||
d:d;h.push(g);e=e.caller}}catch(m){a.logIfDebug(m)}h=h.join("\n")}return k+h}function e(b,c){var d=window.location.origin,f=(new Date).getTime(),e;try{e=window.self!==window.top}catch(m){e=!0}var d={projectRoot:d,"metaData[device][time]":f,"metaData[misc][inIframe]":e,"metaData[misc][CompiledTimestamp]":a.CompiledTimestamp,context:document.location.pathname,message:b.message,name:"Recording Error",payloadVersion:3,releaseStage:"production "+a.CompiledTimestamp,severity:c,notfierVersion:"3.2.0",language:"en-GB",
stacktrace:b.stack||(b.backtrace||b.stacktrace)||g(),apiKey:"38f089fdedbe27e3ca594fb18cdbc78e",ct:"img",cb:(new Date).getTime()},f=[],p;for(p in d)f.push(encodeURIComponent(p)+"="+encodeURIComponent(d[p]));(new Image).src="https://notify.bugsnag.com/js?"+f.sort().join("&")}var b=10,d="[anonymous]",c=/function\s*([\w\-$]+)?\s*\(/i;a.sendToBugsnag=e;var f={};a.assert=function(a,b,c){void 0===c&&(c=1);a||(f[b]=f[b]||0,f[b]++,f[b]>c||e(Error("Assertion failed: "+b),"error"))}})(m||(m={}));(function(a){var g=
function(){function e(){}e.prototype.post=function(b,d,c,f,k,h){void 0===h&&(h=null);d="//"+d+c;var e=!1,l=new XMLHttpRequest;if("withCredentials"in l)l.onreadystatechange=function(){if(l.readyState==a.XHR_DONE&&!e){e=!0;try{200==l.status?k(l.responseText):h(l.status)}catch(b){a.sendToBugsnag(b,"error")}}},l.open("POST",b+d,!0),l.withCredentials=!0,l.setRequestHeader("Content-Type","text/plain"),l.send(f);else{var g=new XDomainRequest;g.onload=function(){k(g.responseText)};g.onerror=function(){h("Not Found"==
g.responseText?404:500)};g.onprogress=function(){};g.open("POST",d);g.send(f)}};e.prototype.sendBeacon=function(a,d,c,f){return"function"==typeof navigator.sendBeacon?(navigator.sendBeacon(a+"//"+d+c,f),!0):!1};e.prototype.exponentialBackoffMs=function(b,d){return a.exponentialBackoffMs(b,d)};return e}();a.XHRPoster=g})(m||(m={}));(function(a){function g(b,c){return a.stringify({__fs:[b,c?c:""]})}function e(b){return a.isLocalhost(a.domainFromHost(b))?b:0==b.indexOf("www.")||0==b.indexOf("app.")?
"r."+b.slice(4):"r."+b}function b(a){return 400<=a||202==a||206==a?!0:!1}function d(a,b,c,d,f,e,g){a="/rec/bundle?OrgId="+a+"&UserId="+b+"&SessionId="+c+"&PageId="+d+"&Seq="+f.Seq;e&&(a+="&PageStartTime="+e);g&&(a+="&DeltaT="+g);return a}var c=function(){function b(a,c){void 0===c&&(c=new f);this._wnd=a;this._messagePoster=c}b.prototype.enqueueEvents=function(b){this._messagePoster.postMessage(this._wnd.parent,a.FS_IFRAME_EVENTS,b)};b.prototype.startPipeline=function(a){};b.prototype.stopPipeline=
function(){};b.prototype.flush=function(){};b.prototype.singSwanSong=function(){};return b}();a.PostMessageEventTransport=c;var f=function(){function b(){}b.prototype.postMessage=function(b,c,d){var f;try{f=a._fs_transport(b)}catch(k){}f?f.send(c,a.stringify(d)):b.postMessage(g(c,d),"*")};return b}();a.PostMessagePoster=f;a.formatPostMessageData=g;a.bundleHost=e;c=function(){function c(b,d,f,k,g){void 0===f&&(f=a.RealTicker);void 0===k&&(k=a.RealTimeout);void 0===g&&(g=new a.XHRPoster);this._ctx=
b;this._onShutdown=d;this._tickerFactory=f;this._timeoutFactory=k;this._poster=g;this._backoffTime=this._backoffRetries=this._byteCount=0;this._bundleSeq=1;this._lastPostTime=0;this._outgoingEventQueue=[];this._bundleQueue=[];this._bundleHost=e(b.getHost());this._protocol=b.getProtocol();this._identity=b.getIdentity();this._lastBundleTime=b.wallTime();this._uploadTicker=new this._tickerFactory(a.UploadInterval);this._swanSong=new a.SwanSong(b,this,k)}c.prototype.protocol=function(){return this._protocol};
c.prototype.enqueueEvents=function(a){this._outgoingEventQueue=this._outgoingEventQueue.concat(a)};c.prototype.startPipeline=function(a){var b=this;this._pageId=a;this.enqueueAndSendBundle();this._uploadTicker.start(function(){b.enqueueAndSendBundle()})};c.prototype.stopPipeline=function(){this._uploadTicker.stop();this._outgoingEventQueue=[];this._bundleQueue=[]};c.prototype.flush=function(){this.maybeSendNextBundle()};c.prototype.singSwanSong=function(){0<this._outgoingEventQueue.length&&this.enqueueNextBundle(!0);
if(0<this._bundleQueue.length||this._pendingBundle){var a=this._bundleQueue.concat();this._pendingBundle&&a.unshift(this._pendingBundle);this._swanSong.sing(this._pageId,a,this._lastBundleTime)}};c.prototype.sendSwanSongBundle=function(a,b,c,f,k,e,g,m,v){void 0===v&&(v=null);a=d(a,b,c,f,k,e,g);this.post(a,k,m,v)};c.prototype.enqueueAndSendBundle=function(){this._pendingBundle?this._pendingBundleFailed&&this._sendPendingBundle():0==this._outgoingEventQueue.length?this.maybeSendNextBundle():this.enqueueNextBundle()};
c.prototype.enqueueNextBundle=function(b){void 0===b&&(b=!1);var c={When:this._outgoingEventQueue[0].When,Seq:this._bundleSeq++,Evts:this._outgoingEventQueue};this._outgoingEventQueue=[];this._bundleQueue.push(c);b&&this._poster.sendBeacon(this._protocol,this._bundleHost,this.bundleUrl(c),a.stringify(c))||this.maybeSendNextBundle()};c.prototype.maybeSendNextBundle=function(){this._pageId&&(!this._pendingBundle&&0!=this._bundleQueue.length)&&(this._pendingBundle=this._bundleQueue.shift(),this._sendPendingBundle())};
c.prototype._sendPendingBundle=function(){var c=this,d=this._ctx.wallTime();if(!(d<this._backoffTime)){var f=this._pendingBundle;this._pendingBundleFailed=!1;this._lastPostTime=this._lastBundleTime=d;this.sendBundle(f,function(b){a.logIfDebug("Sent bundle "+f.Seq+" with "+f.Evts.length+" events");c._pendingBundle=null;c._backoffTime=0;c._backoffRetries=0;c._ctx.wallTime()-c._lastPostTime>a.UploadInterval&&c.maybeSendNextBundle()},function(d){a.logIfDebug("Failed to send events.");b(d)?c._onShutdown():
(c._pendingBundleFailed=!0,c._backoffTime=c._lastPostTime+c._poster.exponentialBackoffMs(c._backoffRetries++,!1))})}};c.prototype.sendBundle=function(a,b,c){void 0===c&&(c=null);this.post(this.bundleUrl(a),a,b,c)};c.prototype.bundleUrl=function(a){return d(this._identity.orgId(),this._identity.userId(),this._identity.sessionId(),this._pageId,a)};c.prototype.post=function(b,c,d,f){void 0===f&&(f=null);var k=null;null!=c&&(k=a.stringify(c),this._byteCount+=k.length,a.logIfDebug("total bytes written: "+
this._byteCount));this._poster.post(this._protocol,this._bundleHost,b,k,d,f)};return c}();a.HttpEventTransport=c;a.exponentialBackoffMs=function(b,c){var d=Math.min(a.BackoffMax,5E3*Math.pow(2,b));return c?d+0.25*Math.random()*d:d};a.isErrorFatal=b})(m||(m={}));(function(a){var g=function(){function a(){this.dict={idx:-1,map:{}};this.nodeCount=1;this.startIdx=0}a.prototype.encode=function(b){function d(){k?1<l?h.push([k.idx,l]):h.push(k.idx):h.push(c)}if(0==b.length)return[];var c=b[0],f,k=Object.prototype.hasOwnProperty.call(this.dict.map,
c)?this.dict.map[c]:null,h=[],g,l=1;for(f=1;f<b.length;f++)if(g=b[f],k&&Object.prototype.hasOwnProperty.call(k.map,g))l++,c=g,k=k.map[g];else{d();var n=this.startIdx+f-l;null==k&&this.nodeCount<a.MAX_NODES&&(k={idx:n,map:{}},this.dict.map[c]=k,this.nodeCount++);this.nodeCount<a.MAX_NODES&&(k.map[g]={idx:n,map:{}},this.nodeCount++);l=1;c=g;k=Object.prototype.hasOwnProperty.call(this.dict.map,g)?this.dict.map[g]:null}d();this.startIdx+=b.length;return h};return a}();g.MAX_NODES=1E4;a.LZJGWEncoder=g;
g=function(){function a(){this._seq=[]}a.prototype.sequence=function(){return this._seq};a.prototype.decode=function(a){for(var d=this._seq.length,c=0;c<a.length;++c){var f=a[c];switch(typeof f){case "string":this._seq.push(f);break;case "number":this._seq.push(this._seq[f]);break;case "object":for(var k=0;k<f[1];k++)this._seq.push(this._seq[f[0]+k])}}return d};return a}();a.LZJGWDecoder=g})(m||(m={}));(function(a){var g=function(){function e(b,d,c){void 0===c&&(c=a.RealTimeout);this._ctx=b;this._transport=
d;this._timeoutFactory=c;this._recover();this._identity=b.getIdentity()}e.prototype.sing=function(b,d,c){a.logIfDebug("Saving "+d.length+" bundles in swan-song.");b={OrgId:this._identity.orgId(),UserId:this._identity.userId(),SessionId:this._identity.sessionId(),PageId:b,Bundles:d,PageStartTime:this._ctx.startTime(),LastBundleTime:c};try{localStorage.singSwanSong=a.stringify(b)}catch(f){}};e.prototype._recover=function(){try{if("singSwanSong"in localStorage){var b=localStorage.singSwanSong;delete localStorage.singSwanSong;
var d=a.parseJson(b);d.Bundles&&d.UserId&&d.SessionId&&d.PageId?(d.OrgId||(d.OrgId=this._identity.orgId()),0<d.Bundles.length&&(a.logIfDebug("Sending "+d.Bundles.length+" bundles as prior page swan song"),this.sendSwanSongBundles(d.OrgId,d.UserId,d.SessionId,d.PageId,d.PageStartTime,d.Bundles,d.LastBundleTime))):a.logIfDebug("Malformed swan song found. Ignoring it.")}}catch(c){a.logIfDebug("Error recovering swan-song: "+c)}};e.prototype.sendSwanSongBundles=function(b,d,c,f,k,h,e,l){var g=this;void 0===
l&&(l=0);var m=null;a.isArray(h)&&(0!==h.length&&void 0!==h[0])&&(1==h.length&&(m=this._ctx.wallTime()-e),this._transport.sendSwanSongBundle(b,d,c,f,h[0],k,m,function(l){a.logIfDebug("Sent "+h[0].Evts.length+" trailing events from last session as Seq "+h[0].Seq);a.windex.Array.prototype.shift.call(h);0<h.length?g.sendSwanSongBundles(b,d,c,f,k,h,e):a.logIfDebug("Done with prior page swan song")},function(m){a.isErrorFatal(m)?a.logIfDebug("Fatal error while sending events, giving up"):(a.logIfDebug("Failed to send events from last session, will retry while on this page"),
g._lastSwanSongRetryTimeout=new g._timeoutFactory(g.sendSwanSongBundles,a.exponentialBackoffMs(l,!0),g,b,d,c,f,k,h,e,l+1))}))};return e}();a.SwanSong=g})(m||(m={}));(function(a){var g=function(){function a(b){this._interval=b;this._handle=-1}a.prototype.start=function(a){-1==this._handle&&(this._handle=setInterval(a,this._interval))};a.prototype.stop=function(){-1!=this._handle&&(clearInterval(this._handle),this._handle=-1)};return a}();a.RealTicker=g;g=function(){function e(b,d,c){void 0===d&&(d=
0);for(var f=[],k=3;k<arguments.length;k++)f[k-3]=arguments[k];this.delay=d;this.timer=-1;this.handler=a.bind.apply(void 0,[b,void 0===c?window:c].concat(f));this.timer=setTimeout(this.handler,d);this.args=f}e.prototype.cancel=function(){clearTimeout(this.timer);this.timer=-1};e.prototype.reset=function(a){void 0===a&&(a=this.delay);this.delay=a;clearTimeout(this.timer);this.timer=setTimeout(this.handler,this.delay)};return e}();a.RealTimeout=g})(m||(m={}));(function(a){var g=function(){function e(b,
d,c,f,k){void 0===c&&(c=function(){return[]});void 0===f&&(f=a.RealTicker);void 0===k&&(k=a.RealTimeout);var h=this;this._ctx=b;this._transport=d;this._gatherExternalEvents=c;this._tickerFactory=f;this._timeoutFactory=k;this._recordingDisabled=!1;this._lastWhen=-1;this._lastUserAction=0;this._hibernating=this._quiescent=!1;this._lastHeartbeat=0;this._heartbeatInterval=a.HeartbeatInitial;this._gotUnload=!1;this._eventQueue=[];this._sampleCurvesTicker=new this._tickerFactory(a.CurveSamplingInterval);
this._processMutationsTicker=new this._tickerFactory(a.MutationProcessingInterval);this._hibernationTimeout=new this._timeoutFactory(function(){h.hibernate()},a.PageInactivityTimeout,this);this._processor=new a.EventProcessor(b)}e.prototype.startPipeline=function(a,d,c){var f=this;this._recordingDisabled||this._pipelineStarted||(this._pipelineStarted=!0,this._frameId=d,this._parentIds=c,this._lastUserAction=this._ctx.now(),this.processEvents(),this._processMutationsTicker.start(function(){f.processEvents()}),
this._sampleCurvesTicker.start(function(){f.processEvents(!0)}),this._transport.startPipeline(a))};e.prototype.enqueue=function(a,d){this.enqueueAt(this._ctx.now(),a,d)};e.prototype.enqueueAt=function(b,d,c){this._hibernating&&a.isUserActionEvent(d)?this._ctx.splitPage():this._recordingDisabled||(b<=this._lastWhen&&(b=this._lastWhen+1),this._lastWhen=b,this._eventQueue.push({When:b,Kind:d,Args:c}),a.isUserActionEvent(d)&&(this._lastUserAction=b,this._hibernationTimeout.reset()))};e.prototype.hibernate=
function(){this.shutdown();this._hibernating=!0};e.prototype.enqueueFirst=function(a,d){0<this._eventQueue.length?this._eventQueue.unshift({When:this._eventQueue[0].When,Kind:a,Args:d}):this.enqueue(a,d)};e.prototype.addUnload=function(){this._gotUnload||(this._gotUnload=!0,this.enqueue(a.EVENT_UNLOAD,[]),this._lastUserAction=this._ctx.now(),this.singSwanSong())};e.prototype.shutdown=function(){this._flush();this.addUnload();this._flush();this._recordingDisabled=!0;this.stopPipeline();this._hibernationTimeout.cancel()};
e.prototype._flush=function(){this.processEvents();this._transport.flush()};e.prototype.prequeue=function(a,d){this._recordingDisabled||this._eventQueue.unshift({When:0,Kind:a,Args:d})};e.prototype.appendToQueue=function(a){this._eventQueue=this._eventQueue.concat(a)};e.prototype.singSwanSong=function(){this._recordingDisabled||(this.processEvents(),this._transport.singSwanSong())};e.prototype.rebaseIframe=function(a){for(var d=0,c=this._eventQueue.length;d<c;d++){var f=this._eventQueue[d],k=f.When+
this._ctx.startTime()-a;0>k&&(k=0);f.When=k}};e.prototype.processEvents=function(b){if(this._pipelineStarted&&!this._hibernating&&(this._ctx.now()-this._lastUserAction>a.UserInactivityTimeout?this._quiescent||(this._quiescent=!0,this._heartbeatInterval=a.HeartbeatInitial,this._lastHeartbeat=this._ctx.now()):this._quiescent=!1,!this._quiescent||this.maybeSendHeartbeat())){var d=this._eventQueue;this._eventQueue=[];d=this._processor.processQueue(d);b||(d=d.concat(this._gatherExternalEvents()));this.ensureFrameIds(d);
0!=d.length&&this._transport.enqueueEvents(d)}};e.prototype.maybeSendHeartbeat=function(){var b=this._ctx.now();return b-this._lastHeartbeat>=this._heartbeatInterval?(this._lastHeartbeat=b,this._heartbeatInterval*=2,this._heartbeatInterval>a.HeartbeatMax&&(this._heartbeatInterval=a.HeartbeatMax),this.enqueue(a.EVENT_HEARTBEAT,[]),!0):!1};e.prototype.ensureFrameIds=function(a){if(this._frameId)for(var d=this._parentIds,c=d&&0<d.length,f=0;f<a.length;++f){var k=a[f];k.FId||(k.FId=this._frameId);c&&
!k.PIds&&(k.PIds=d)}};e.prototype.stopPipeline=function(){this._pipelineStarted&&(this._sampleCurvesTicker.stop(),this._processMutationsTicker.stop(),this._eventQueue=[],this._transport.stopPipeline())};return e}();a.EventQueue=g})(m||(m={}));(function(a){var g=function(){function e(a,d){this._queue=a;this._wnd=d;this._overflow=this._enabled=!1;this._total=0}e.prototype.enable=function(){var b=this;b._enabled||(b._enabled=!0,this._wnd.console?(console.log&&console.log.apply&&(b._oldLog=console.log,
console.log=a.$entry(function(){b.addLog("log",arguments);return b._oldLog.apply(this,arguments)})),console.info&&console.info.apply&&(b._oldInfo=console.info,console.info=a.$entry(function(){b.addLog("info",arguments);return b._oldInfo.apply(this,arguments)})),console.warn&&console.warn.apply&&(b._oldWarn=console.warn,console.warn=a.$entry(function(){b.addLog("warn",arguments);return b._oldWarn.apply(this,arguments)})),console.error&&console.error.apply&&(b._oldError=console.error,console.error=
a.$entry(function(){b.addLog("error",arguments);return b._oldError.apply(this,arguments)}))):b.addLog("log",["NOTE: Log messages cannot be captured on IE9"]),b._oldOnError=this._wnd.onerror,this._wnd.onerror=function(a,c,f){b.addError(a,c,f);if(b._oldOnError)return b._oldOnError.apply(this,arguments)})};e.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._oldLog&&(console.log=this._oldLog),this._oldInfo&&(console.info=this._oldInfo),this._oldWarn&&(console.warn=this._oldWarn),this._oldError&&
(console.error=this._oldError),this._wnd.onerror=this._oldOnError)};e.prototype.addLog=function(b,d){if(this.checkOverflow()){for(var c=[b],f=0;f<d.length;++f)c.push(a.stringify(d[f],1E3));this._queue.enqueue(a.EVENT_LOG,c)}};e.prototype.addError=function(b,d,c){this.checkOverflow()&&("object"==typeof b&&(b=a.stringify(b,1E3)),"object"==typeof d&&(d=a.stringify(d,100)),"object"==typeof c&&(c=-1),this._queue.enqueue(a.EVENT_ERROR,[b,d,c]))};e.prototype.checkOverflow=function(){if(this._overflow)return!1;
if(this._total==a.MAX_LOGS_PER_PAGE)return this._queue.enqueue(a.EVENT_LOG,["warn",e.OVERFLOW_MSG]),this._overflow=!0,!1;this._total++;return!0};return e}();g.OVERFLOW_MSG='"[received more than '+a.MAX_LOGS_PER_PAGE+' messages; no longer recording console]"';a.ConsoleWatcher=g})(m||(m={}));(function(a){function g(a,b){var d=Object.getOwnPropertyDescriptor(a.prototype,b);Object.defineProperty(a.prototype,b,{set:function(a){var b=this;setTimeout(function(){c&&c(b)},0);return d.set.call(this,a)},get:function(){return d.get.call(this)}})}
function e(a){switch(a.type){case "checkbox":case "radio":return""+a.checked;default:return(a=a.value)||(a=""),""+a}}var b=function(){function b(d,f){var g=this;this._onchange=d;this._checkElem=f;this._fallback=!1;this._elems={};this._values={};c=function(b){var c=a.fsid(b);if(c&&(b=g._elems[c])){var d=e(b);d!=g._values[c]&&(g._onchange(b),g._values[c]=d)}}}b.prototype.hookEvents=function(){var a;(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"))&&a.set?(d||(g(HTMLInputElement,
"value"),g(HTMLInputElement,"checked"),g(HTMLSelectElement,"value"),g(HTMLTextAreaElement,"value"),d=!0),a=!0):a=!1;a||(this._fallback=!0)};b.prototype.addInput=function(b){var c=a.fsid(b);this._elems[c]=b;this._values[c]=e(b);a:switch(b.type){case "checkbox":case "radio":c=b.checked!=b.hasAttribute("checked");break a;default:var c=b.value||"",d=b.getAttribute("value")||"",c=c!=d}c&&this._onchange(b)};b.prototype.invokeGlobalOnChange=function(a){c&&c(a)};b.prototype.tick=function(){for(var a in this._elems)if(!this._checkElem(this._elems[a]))delete this._elems[a],
delete this._values[a];else if(this._fallback){var b=this._elems[a],c=e(b);c!=this._values[a]&&(this._onchange(b),this._values[a]=c)}};b.prototype.shutdown=function(){c=null};b.prototype._usingFallback=function(){return this._fallback};b.prototype._trackingElem=function(a){return!!this._elems[a]};return b}();a.InputWatcher=b;var d=!1,c;a.valueOfInputishElem=e})(m||(m={}));(function(a){a.Node_ELEMENT_NODE=1;a.Node_ATTRIBUTE_NODE=2;a.Node_TEXT_NODE=3;a.Node_CDATA_SECTION_NODE=4;a.Node_ENTITY_REFERENCE_NODE=
5;a.Node_ENTITY_NODE=6;a.Node_PROCESSING_INSTRUCTION_NODE=7;a.Node_COMMENT_NODE=8;a.Node_DOCUMENT_NODE=9;a.Node_DOCUMENT_TYPE_NODE=10;a.Node_DOCUMENT_FRAGMENT_NODE=11;a.Node_NOTATION_NODE=12;a.XHR_UNSENT=0;a.XHR_OPENED=1;a.XHR_HEADERS_RECEIVED=2;a.XHR_LOADING=3;a.XHR_DONE=4})(m||(m={}));(function(a){function g(a){return"_fsblocked"in a}function e(a){return a._fsblocked}function b(a,b){a._fsblocked=b}function d(b,c){if(g(b.node))for(var d=b,f=b.parent;f;f=f.parent){f.blockedChildSet=f.blockedChildSet||
{};for(var k in d.blockedChildSet)delete f.blockedChildSet[k];f.blockedChildSet[d.id]=d;if(a.hasNKeys(f.blockedChildSet,2))d=f;else if(a.hasMoreThanNKeys(f.blockedChildSet,2))break}}function c(a){return a?r[a._fs]:null}function f(a){return a&&a._fs||0}function k(a,b,c){h(b);c=c||a.lastChild;b.parent=a;if(b.prev=c)d=[b,c.next],c.next=d[0],b.next=d[1];null==b.prev?a.child=b:b.prev.next=b;null==b.next?a.lastChild=b:b.next.prev=b;var d}function h(b){if(b.parent){if(a.hasMoreThanNKeys(b.blockedChildSet,
0)||g(b.node))for(var c=a.hasNKeys(b.blockedChildSet,1)?a.firstKey(b.blockedChildSet):b.id,d=c&&b.parent;d&&d.blockedChildSet&&d.blockedChildSet[c];){delete d.blockedChildSet[c];if(a.hasNKeys(d.blockedChildSet,1)){for(var c=d.id,f=a.firstValue(d.blockedChildSet),d=d.parent;d&&d.blockedChildSet&&d.blockedChildSet[c];)delete d.blockedChildSet[c],d.blockedChildSet[f.id]=f,d=d.parent;break}d=d.parent}b.parent.child==b&&(b.parent.child=b.next);b.parent.lastChild==b&&(b.parent.lastChild=b.prev);b.prev&&
(b.prev.next=b.next);b.next&&(b.next.prev=b.prev);b.parent=b.prev=b.next=null;r[b.id]=null;b.node._fs==b.id&&(b.node._fs=0);b.id=0;b.child&&m(b.child)}}function m(b){for(b=[b];0<b.length&&1E4>b.length;){var c=b.pop();c.node._fs=c.id=0;c.next&&b.push(c.next);c.child&&b.push(c.child)}a.assert(1E4>b.length,"clearIds is fast")}function l(a,b){if(a.attributes&&0<a.attributes.length)for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];b(d.name.toLowerCase(),d.value)}}function n(a,b,c,d){if("class"==
b&&0>c.indexOf("_fs_block_"))c+=" _fs_block_"+e(a);else if("type"==b&&"object"==a.tagName.toLowerCase()||"value"==b||"checked"==b||"src"==b||"data"==b||"alt"==b)c=null;return c}a.isBlocked=g;a.blockKind=e;a.setBlocked=b;var r={};a.mirrorFor=c;a.fsid=f;a.fsidIfNotBlocked=function(a){return g(a)?0:f(a)};a.removeMirror=h;a.clearIds=m;var p=function(){function f(a){this._blocker=a;this._curId=1}f.prototype.curId=function(){return this._curId};f.prototype.tokenizeNode=function(a,b,d,f){var k=this._curId;
try{var e=c(a),h=c(b);a=[];this.tokeNode(e,h,d,a,f);return a}catch(l){return this._curId=k,[]}};f.prototype.tokeNode=function(b,c,f,e,h){if("SCRIPT"==f.nodeName||f.nodeType==a.Node_COMMENT_NODE)return null;var g={id:this._curId++,node:f};r[g.id]=g;f._fs=g.id;b&&k(b,g,c);b=f.nodeName;"http://www.w3.org/2000/svg"==f.namespaceURI&&(b="svg:"+b);e.push("<"+b);try{var m=this.processBlockedElem(f,e);if(m)return d(g,m),g;h&&h(f);l(f,function(a,b){e.push(":"+a);e.push(b)});if(f.firstChild){e.push("[");for(var m=
null,n=f.firstChild;n;n=n.nextSibling){var t=this.tokeNode(g,m,n,e,h);t&&(m=t)}e.push("]")}f.nodeType==a.Node_TEXT_NODE&&e.push(f.textContent)}catch(p){}return g};f.prototype.processBlockedElem=function(c,d){var f=this;if(c.nodeType==a.Node_ELEMENT_NODE&&this._blocker){var k=this._blocker.isBlocked(c);if(k){b(c,k);var e,h=!1;l(c,function(a,b){b=n(c,a,b,f._blocker);"class"==a?e=!0:"style"==a&&(h=!0);null!=b&&(d.push(":"+a),d.push(b))});e||(d.push(":class"),d.push("_fs_block_"+k));h||(d.push(":style"),
d.push(this._blocker.mungeBlockedStyle(c,"")));return k}}return null};return f}();a.NodeEncoder=p;a.rewriteBlockedAttribute=n})(m||(m={}));(function(a){function g(){s=!1;var a=w;w=[];a.sort(function(a,b){return a.uid_-b.uid_});var b=!1;a.forEach(function(a){var c=a.takeRecords();e(a);c.length&&(a.callback_(c,a),b=!0)});b&&g()}function e(a){a.nodes_.forEach(function(b){(b=l.get(b))&&b.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function b(a,b){for(var c=a;c;c=c.parentNode){var d=
l.get(c);if(d)for(var f=0;f<d.length;f++){var k=d[f],e=k.options;(c===a||e.subtree)&&(e=b(e))&&k.enqueue(e)}}}function d(a){this.callback_=a;this.nodes_=[];this.records_=[];this.uid_=++v}function c(a,b){this.type=a;this.target=b;this.addedNodes=[];this.removedNodes=[];this.oldValue=this.attributeNamespace=this.attributeName=this.nextSibling=this.previousSibling=null}function f(a){if(u)return u;var b=q,d=new c(b.type,b.target);d.addedNodes=b.addedNodes.slice();d.removedNodes=b.removedNodes.slice();
d.previousSibling=b.previousSibling;d.nextSibling=b.nextSibling;d.attributeName=b.attributeName;d.attributeNamespace=b.attributeNamespace;d.oldValue=b.oldValue;u=d;u.oldValue=a;return u}function k(a,b,c){this.observer=a;this.target=b;this.options=c;this.transientObservedNodes=[]}a.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||d;var h=Object.defineProperty,m=Date.now()%1E9,l=new (window.WeakMap||function(){var a=function(){this.name="__st"+(1E9*Math.random()>>>0)+(m++ +"__")};
a.prototype={set:function(a,b){var c=a[this.name];c&&c[0]===a?c[1]=b:h(a,this.name,{value:[a,b],writable:!0})},get:function(a){var b;return(b=a[this.name])&&b[0]===a?b[1]:void 0}};return a}()),n=window.setImmediate||window.msSetImmediate;if(!n){var r=[],p=String(Math.random());window.addEventListener("message",function(a){a.data===p&&(a=r,r=[],a.forEach(function(a){a()}))});n=function(a){for(var b=1;b<arguments.length;b++);r.push(a);window.postMessage(p,"*");return 0}}var s=!1,w=[],v=0;d.prototype=
{observe:function(a,b){a=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||a;if(!b.childList&&!b.attributes&&!b.characterData||b.attributeOldValue&&!b.attributes||b.attributeFilter&&b.attributeFilter.length&&!b.attributes||b.characterDataOldValue&&!b.characterData)throw new SyntaxError;var c=l.get(a);c||l.set(a,c=[]);for(var d,f=0;f<c.length;f++)if(c[f].observer===this){d=c[f];d.removeListeners();d.options=b;break}d||(d=new k(this,a,b),c.push(d),this.nodes_.push(a));d.addListeners()},
disconnect:function(){this.nodes_.forEach(function(a){a=l.get(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.observer===this){c.removeListeners();a.splice(b,1);break}}},this);this.records_=[]},takeRecords:function(){var a=this.records_;this.records_=[];return a}};var q,u;k.prototype={enqueue:function(a){var b=this.observer.records_,c=b.length;if(0<b.length){var d=b[c-1];d=d===a?d:!u||d!==u&&d!==q?null:u;if(d){b[c-1]=d;return}}else w.push(this.observer),s||(s=!0,n(g));b[c]=a},addListeners:function(){this.addListeners_(this.target)},
addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",this,!0);b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.addEventListener("DOMNodeInserted",this,!0);(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0);b.characterData&&a.removeEventListener("DOMCharacterDataModified",
this,!0);b.childList&&a.removeEventListener("DOMNodeInserted",this,!0);(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a);this.transientObservedNodes.push(a);var b=l.get(a);b||l.set(a,b=[]);b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[];a.forEach(function(a){this.removeListeners_(a);a=l.get(a);for(var b=0;b<a.length;b++)if(a[b]===this){a.splice(b,
1);break}},this)},handleEvent:function(a){switch(a.type){case "DOMAttrModified":var d=a.attrName,k=a.relatedNode.namespaceURI,e=a.target,h=q=new c("attributes",e);h.attributeName=d;h.attributeNamespace=k;var l=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;b(e,function(a){if(a.attributes&&(!a.attributeFilter||!a.attributeFilter.length||-1!==a.attributeFilter.indexOf(d)||-1!==a.attributeFilter.indexOf(k)))return a.attributeOldValue?f(l):h});break;case "DOMCharacterDataModified":e=a.target;
h=q=new c("characterData",e);l=a.prevValue;b(e,function(a){if(a.characterData)return a.characterDataOldValue?f(l):h});break;case "DOMNodeRemoved":this.addTransientObserver(a.target);case "DOMNodeInserted":var e=a.relatedNode,g=a.target,m;"DOMNodeInserted"===a.type?(a=[g],m=[]):(a=[],m=[g]);var n=g.previousSibling,g=g.nextSibling,h=q=new c("childList",e);h.addedNodes=a;h.removedNodes=m;h.previousSibling=n;h.nextSibling=g;b(e,function(a){if(a.childList)return h})}q=u=void 0}}})(m||(m={}));(function(a){var g=
function(){function e(b,d,c){void 0===c&&(c=function(a,b){});this._ctx=b;this._blocker=d;this._visitor=c;this._sentDomSnapshot=!1;this._records=[];this._blockedDims={};this._wnd=b.getWindow();this._encoder=new a.NodeEncoder(d)}e.prototype.hookMutations=function(b){var d=this;void 0===b&&(b=this._wnd.document.documentElement);this._root=b;this._sentDomSnapshot=!1;this._lz=new a.LZJGWEncoder;this._observer=new a.MutationObserver(function(a){d._records=d._records.concat(a)});this._observer.observe(b,
{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})};e.prototype.shutdown=function(){this._observer&&this._observer.disconnect();var b=a.mirrorFor(this._root);b&&a.clearIds(b);this._records=[]};e.prototype.processMutations=function(){if(!this._root)return[];var b=this._ctx.now(),d=[];this._sentDomSnapshot||(this.genInsert(b,d,null,this._root,null),this.resizeRelatedBlockedElements(b,d,this._root),this._sentDomSnapshot=!0);if(0==this._records.length)return d;
var c={},f={};this.processRecords(b,d,f,c);for(var k in f){var e=k.split(":");d.push({Kind:a.EVENT_MUT_ATTR,When:b,Args:[parseInt(e[0]),e[1],f[k]]})}for(k in c)d.push({Kind:a.EVENT_MUT_TEXT,When:b,Args:[parseInt(k),c[k]]});this._records=[];return d};e.prototype.processRecords=function(b,d,c,f){for(var e={},h={},g=0;g<this._records.length;++g)try{var l=this._records[g],m=a.fsid(l.target);if(m)switch(e[m]=l.target,l.type){case "childList":if(0<l.removedNodes.length)for(var r=0;r<l.removedNodes.length;++r){var p=
a.mirrorFor(l.removedNodes[r]);p&&p.id&&p.parent==a.mirrorFor(l.target)&&p.next==a.mirrorFor(l.nextSibling)&&this.genRemove(b,d,p)}m&&(h[m]=l.target);break;case "characterData":var s=l.target.textContent;l.oldValue!=s&&(a.isBlocked(l.target)||(f[m]=s));break;case "attributes":var w=l.attributeName,v=w.toLowerCase();l.target.hasAttribute(w)?(s=l.target.getAttribute(w),l.oldValue!=s&&(s=this.rewriteAttr(l.target,v,s),null!==s&&(c[m+":"+v]=s))):c[m+":"+v]=null}}catch(q){}for(var u in h)c=h[u],(f=a.mirrorFor(c))&&
f.id&&this.diff(b,d,c,f.child,c.firstChild);for(u in e)c=e[u],this.resizeRelatedBlockedElements(b,d,c)};e.prototype.diff=function(b,d,c,f,e){for(var h=[];f&&e;){var g=a.mirrorFor(e);a.fsid(e)?f.id==g.id?(f=f.next,e=e.nextSibling):(h.push({remove:f}),f=f.next):(h.push({insert:[c,e,f.node]}),e=e.nextSibling)}for(;f;f=f.next)h.push({remove:f});for(;e;e=e.nextSibling)h.push({insert:[c,e,null]});for(c=0;c<h.length;c++)f=h[c],f.insert?this.genInsert(b,d,f.insert[0],f.insert[1],f.insert[2]):f.remove&&this.genRemove(b,
d,f.remove)};e.prototype.resizeRelatedBlockedElements=function(b,d,c){var f=a.mirrorFor(c);if(f){c=[f];for(f=0;c.length&&1E3>++f;){var e=c.pop();if(a.isBlocked(e.node))this.addPlaceholderResize(b,d,e.node);else if(e.blockedChildSet)for(var h in e.blockedChildSet)a.windex.Object.prototype.hasOwnProperty.call(e.blockedChildSet,h)&&c.push(e.blockedChildSet[h])}a.assert(1E3>f,"Searching for blocked descendants is fast")}else{for(;c&&!a.fsid(c);)c=c.parentNode;c&&a.isBlocked(c)&&this.addPlaceholderResize(b,
d,c)}};e.prototype.addPlaceholderResize=function(b,d,c){try{var f=c.getBoundingClientRect(),e=Math.floor(f.width),h=Math.floor(f.height),g=a.fsid(c),l=this._blockedDims[g];l&&l.w==e&&l.h==h||(this._blockedDims[g]={w:e,h:h},d.push({When:b,Kind:a.EVENT_PLACEHOLDER_SIZE,Args:[g,e,h]}))}catch(m){}};e.prototype.genInsert=function(b,d,c,f,e){var h=this;if(c&&a.isBlocked(c))return null;var g=a.fsid(c)||-1,l=a.fsid(e)||-1;c=this._encoder.tokenizeNode(c,e,f,function(a){h._visitor(b,a)});0<c.length&&d.push({When:b,
Kind:a.EVENT_MUT_INSERT,Args:[g,l,this._lz.encode(c)]})};e.prototype.genRemove=function(b,d,c){var f=c.id;a.removeMirror(c);if(0<d.length&&(c=d[d.length-1],c.Kind==a.EVENT_MUT_REMOVE)){c.Args.push(f);return}d.push({When:b,Kind:a.EVENT_MUT_REMOVE,Args:[f]})};e.prototype.rewriteAttr=function(b,d,c){a.isBlocked(b)&&(c=a.rewriteBlockedAttribute(b,d,c,this._blocker));return c};return e}();a.MutationWatcher=g})(m||(m={}));(function(a){a.gatherPerformanceStats=function(){for(var a=[],e=0,b="connectEnd connectStart domComplete domContentLoadedEventEnd domContentLoadedEventStart domInteractive domLoading domainLookupEnd domainLookupStart fetchStart loadEventEnd loadEventStart navigationStart redirectEnd redirectStart requestStart responseEnd responseStart secureConnectionStart unloadEventEnd unloadEventStart".split(" ");e<
b.length;e++){var d=performance.timing[b[e]],d=void 0==d?-1:d;a.push(d)}return a}})(m||(m={}));(function(a){var g=function(){function e(b,d,c,f){var e=this;this._ctx=b;this._queue=d;this._blocker=c;this._onFrameCreated=f;this._clientHeight=this._clientWidth=this._curWindowScrollY=this._curWindowScrollX=-1;this._curInnerWidth=0;this._scrollTimeouts={};this._quirks=!1;this._listeners=new a.DomListeners;this._initialized=!1;this._wnd=b.getWindow();this._doc=this._wnd.document;this._loc=this._wnd.location;
this._hst=this._wnd.history;this._quirks="BackCompat"==this._doc.compatMode;this._currentUrl=this._loc.href;this._inputWatcher=new a.InputWatcher(function(a){e.addChangeElem(a)},function(b){return!!a.fsid(b)});this._mutWatcher=new a.MutationWatcher(b,c,function(a,b){e.visitNode(a,b)})}e.prototype.onDomLoad=function(){var b=this;this.addDomLoaded();this.addResize();this._mutWatcher.hookMutations();this._inputWatcher.hookEvents();this._scrollListener=this._listeners.add(this.docElem(),"scroll",!0,function(a){b.addScroll(a)});
this._listeners.add(this._wnd,"mousemove",!0,function(a){b.addMouseMove(a)});this._listeners.add(this._wnd,"mousedown",!0,function(a){b.addMouseDown(a)});this._listeners.add(this._wnd,"mouseup",!0,function(a){b.addMouseUp(a)});this._listeners.add(this._wnd,"keydown",!0,function(a){b.addKeyDown(a)});this._listeners.add(this._wnd,"keyup",!0,function(a){b.addKeyUp(a)});this._listeners.add(this._wnd,"click",!0,function(a){b.addClick(a)});this._listeners.add(this._wnd,"dblclick",!0,function(a){b.addDblClick(a)});
this._listeners.add(this._wnd,"focus",!0,function(a){b.addFocus(a)});this._listeners.add(this._wnd,"blur",!0,function(a){b.addBlur(a)});this._listeners.add(this._wnd,"change",!0,function(a){b.addChange(a)});this._listeners.add(this._wnd,"touchstart",!0,function(c){b.addTouchEvent(c,a.EVENT_TOUCHSTART);b.addWindowScroll()});this._listeners.add(this._wnd,"touchend",!0,function(c){b.addTouchEvent(c,a.EVENT_TOUCHEND);b.addWindowScroll()});this._listeners.add(this._wnd,"touchmove",!0,function(c){b.addTouchEvent(c,
a.EVENT_TOUCHMOVE);b.addWindowScroll()});this._listeners.add(this._wnd,"touchcancel",!0,function(c){b.addTouchEvent(c,a.EVENT_TOUCHCANCEL)});this._listeners.add(this._wnd,"play",!0,function(c){b.addPlayPauseEvent(c,a.EVENT_PLAY)});this._listeners.add(this._wnd,"pause",!0,function(c){b.addPlayPauseEvent(c,a.EVENT_PAUSE)});this._listeners.add(this._wnd,"scroll",!1,function(a){b.addWindowScroll()});this._listeners.add(this._wnd,"resize",!1,function(a){b.addResize()});this._listeners.add(this._wnd,"submit",
!1,function(a){b.addFormSubmit(a)});this._listeners.add(this._wnd,"focus",!1,function(a){b.addWindowFocus(a)});this._listeners.add(this._wnd,"blur",!1,function(a){b.addWindowBlur(a)});this._listeners.add(this._wnd,"popstate",!1,function(){b.addNavigate()});this._hst.pushState&&(this._pushHook=a.activateHook(this._hst,"pushState").afterSync(function(){return b.addNavigate()}),this._replaceHook=a.activateHook(this._hst,"replaceState").afterSync(function(){return b.addNavigate()}));var d=this._wnd.navigator.userAgent;
-1<d.indexOf("MSIE ")||(-1<d.indexOf("Trident/")||-1<d.indexOf("Edge/"))||this.shimDocumentWrite();this._initialized=!0};e.prototype.onLoad=function(){this.addPerformanceData();this.addLoad();this.addResize()};e.prototype.unShimDocumentWrite=function(){this._docOpenHook&&this._docOpenHook.disable();this._docWriteHook&&this._docWriteHook.disable();this._docWritelnHook&&this._docWritelnHook.disable();this._docCloseHook&&this._docCloseHook.disable()};e.prototype.shimDocumentWrite=function(){var b=this,
d=this._mutWatcher,c=function(c,f){var e=a.mirrorFor(c);if(e){var k=[];d.genRemove(f,k,e);e=k[0];b._queue.enqueueAt(e.When,e.Kind,e.Args)}},f=function(a){a.oldEl=this.documentElement;a.now=b._ctx.now()},e=function(f){if(this.documentElement!=f.oldEl){d.hookMutations();var e=[];c(f.oldEl,f.now);e.push({Kind:a.EVENT_SET_FRAME_BASE,When:f.now,Args:[a.baseUri(this),a.doctypeString(this)]},{Kind:a.EVENT_DOMLOADED,When:f.now,Args:[]});b._listeners.remove(b._scrollListener);b._scrollListener=b._listeners.add(b.docElem(),
"scroll",!0,function(a){b.addScroll(a)});e.push.apply(e,d.processMutations());for(f=0;f<e.length;f++){var k=e[f];b._queue.enqueueAt(k.When,k.Kind,k.Args)}}};this._docOpenHook=a.activateHook(this._wnd.document,"open").before(f).afterSync(function(a){!this.documentElement&&a.oldEl&&c(a.oldEl,a.now)});this._docWriteHook=a.activateHook(this._wnd.document,"write").before(f).afterAsync(e);this._docWritelnHook=a.activateHook(this._wnd.document,"writeln").before(f).afterAsync(e);this._docCloseHook=a.activateHook(this._wnd.document,
"close").before(f).afterAsync(e)};e.prototype.bundleEvents=function(){this._inputWatcher.tick();this.addWindowInnerWidth();return this._mutWatcher.processMutations()};e.prototype.shutdown=function(){this._initialized&&(this._initialized=!1,this._listeners.clear(),this._pushHook&&this._pushHook.disable(),this._replaceHook&&this._replaceHook.disable(),this._inputWatcher.shutdown(),this._mutWatcher.shutdown(),this.unShimDocumentWrite())};e.prototype.docElem=function(){return this._doc.documentElement};
e.prototype.visitNode=function(b,d){switch(d.nodeName){case "BODY":this.addResize();break;case "INPUT":case "TEXTAREA":case "SELECT":this._inputWatcher.addInput(d);break;case "FRAME":case "IFRAME":this._onFrameCreated(d);break;case "VIDEO":case "AUDIO":d.paused||this.addPlayPauseEventById(a.fsid(d),a.EVENT_PLAY)}};e.prototype.addMouseMove=function(b){b=a.fsid(b.target)?[b.clientX,b.clientY,a.fsid(b.target)]:[b.clientX,b.clientY];this._queue.enqueue(a.EVENT_MOUSEMOVE,b)};e.prototype.addMouseDown=function(b){this._queue.enqueue(a.EVENT_MOUSEDOWN,
[b.clientX,b.clientY])};e.prototype.addMouseUp=function(b){this._queue.enqueue(a.EVENT_MOUSEUP,[b.clientX,b.clientY])};e.prototype.addTouchEvent=function(a,d){if(void 0!==a.changedTouches)for(var c=0;c<a.changedTouches.length;++c){var f=a.changedTouches[c];isNaN(parseInt(f.identifier))&&(f.identifier=0);this._queue.enqueue(d,[f.identifier,f.clientX,f.clientY])}};e.prototype.addPlayPauseEvent=function(b,d){var c=a.fsid(b.target);c&&this.addPlayPauseEventById(c,d)};e.prototype.addPlayPauseEventById=
function(a,d){this._queue.enqueue(d,[a])};e.prototype.addWindowFocus=function(b){this._queue.enqueue(a.EVENT_WINDOW_FOCUS,[])};e.prototype.addWindowBlur=function(b){this._queue.enqueue(a.EVENT_WINDOW_BLUR,[])};e.prototype.maybeAddValueChange=function(){var a=this._doc.activeElement;a&&this._inputWatcher.invokeGlobalOnChange(a)};e.prototype.addKeyDown=function(b){var d=this._doc.activeElement;if(!d||a.fsidIfNotBlocked(d))this.maybeAddValueChange(),this._queue.enqueue(a.EVENT_KEYDOWN,[b.keyCode])};
e.prototype.addKeyUp=function(b){var d=this._doc.activeElement;if(!d||a.fsidIfNotBlocked(d))this.maybeAddValueChange(),this._queue.enqueue(a.EVENT_KEYUP,[b.keyCode])};e.prototype.addWindowInnerWidth=function(){var b=this._wnd.innerWidth;b!=this._curInnerWidth&&(this._queue.enqueue(a.EVENT_INNERWIDTH,[b]),this._curInnerWidth=b)};e.prototype.doWorkInScrollTimeout=function(b,d){var c=this;b in this._scrollTimeouts||(this._scrollTimeouts[b]=d,setTimeout(function(){if(b in c._scrollTimeouts){var a=c._scrollTimeouts[b];
delete c._scrollTimeouts[b];a()}},a.ScrollSampleInterval))};e.prototype._fireScrollTimeouts=function(){for(var a in this._scrollTimeouts)this._scrollTimeouts[a](),delete this._scrollTimeouts[a];this._scrollTimeouts=[]};e.prototype.addWindowScroll=function(){var b=this,d=a.fsid(this._doc.body);d&&this.doWorkInScrollTimeout(d,function(){var c,f;"pageXOffset"in b._wnd?(c=b._wnd.pageXOffset,f=b._wnd.pageYOffset):(c=b._doc.body.scrollLeft,f=b._doc.body.scrollTop);if(c!=b._curWindowScrollX||f!=b._curWindowScrollY)b._queue.enqueue(a.EVENT_SCROLL,
[d,c,f]),b._curWindowScrollX=c,b._curWindowScrollY=f;b.addWindowInnerWidth()})};e.prototype.addScroll=function(b){var d=this,c=b.target,f=a.fsid(c);f&&this.doWorkInScrollTimeout(f,function(){d._queue.enqueue(a.EVENT_SCROLL,[f,c.scrollLeft,c.scrollTop])})};e.prototype.addResize=function(){var b,d;this._quirks?(b=this._doc.body.clientWidth,d=this._doc.body.clientHeight):(b=this.docElem().clientWidth,d=this.docElem().clientHeight);if(b!=this._clientWidth||d!=this._clientHeight)this._clientWidth=b,this._clientHeight=
d,b=Math.max(this._wnd.innerWidth||-1,this._clientWidth),this.isMediaValue("width",b)||(b=this.findMediaValue("width",b,b+128)||b),d=Math.max(this._wnd.innerHeight,this._clientHeight),this.isMediaValue("height",d)||(d=this.findMediaValue("height",d,d+128)||d),b==this._clientWidth&&d==this._clientHeight?this._queue.enqueue(a.EVENT_RESIZE,[this._clientWidth,this._clientHeight]):this._queue.enqueue(a.EVENT_RESIZE,[this._clientWidth,this._clientHeight,b,d])};e.prototype.isMediaValue=function(a,d){if(!this._wnd.matchMedia)return!0;
var c=this._wnd.matchMedia("(min-"+a+": "+d+"px)");if(!c)return!0;var f=this._wnd.matchMedia("(max-"+a+": "+d+"px)");return f?c.matches&&f.matches:!0};e.prototype.findMediaValue=function(a,d,c){if(!this._wnd.matchMedia)return 0;for(;d<c;){var f=Math.floor((d+c)/2);if(this._wnd.matchMedia("(min-"+a+": "+f+"px)").matches){if(this._wnd.matchMedia("(max-"+a+": "+f+"px)").matches)return f;d=f+1}else c=f-1}return 0};e.prototype.addDomLoaded=function(){this._queue.enqueue(a.EVENT_DOMLOADED,[])};e.prototype.addLoad=
function(){this._queue.enqueue(a.EVENT_LOAD,[])};e.prototype.addPerformanceData=function(){window.performance&&window.performance.timing&&this._queue.enqueue(a.NAVIGATION_TIMING,a.gatherPerformanceStats())};e.prototype.addNavigate=function(){var b=this._loc.href;this._currentUrl!=b&&(this._currentUrl=b,this._queue.enqueue(a.EVENT_NAVIGATE,[this._loc.href,this._doc.title]))};e.prototype.addClick=function(b){var d=b.target,c=a.fsid(d);c&&(d=d.getBoundingClientRect(),this._queue.enqueue(a.EVENT_CLICK,
[c,b.clientX,b.clientY,d.left,d.top,d.width,d.height]))};e.prototype.addDblClick=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_DBL_CLICK,[b])};e.prototype.addFormSubmit=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_FORM_SUBMIT,[b])};e.prototype.addFocus=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_FOCUS,[b])};e.prototype.addBlur=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_BLUR,[b])};e.prototype.addChange=function(a){this._inputWatcher.invokeGlobalOnChange(a.target)};
e.prototype.addChangeElem=function(b){var d=a.fsidIfNotBlocked(b);d&&this._queue.enqueue(a.EVENT_VALUECHANGE,[d,a.valueOfInputishElem(b)])};return e}();a.EventWatcher=g})(m||(m={}));(function(a){function g(b){try{var c=a.parseJson(b);if("__fs"in c)return c.__fs}catch(d){}return[]}function e(a){var c=a.src;return!a.hasAttribute("src")||"about:blank"==c||0==c.indexOf("javascript:")||0==c.indexOf(b)}a.FS_REQUEST_FRAME_ID="RequestFrameId";a.FS_SET_FRAME_ID_CMD="SetFrameId";a.FS_IFRAME_EVENTS="EvtBundle";
a.FS_SHUTDOWN_FRAME="ShutdownFrame";a.FS_RESTART_FRAME="RestartFrame";var b=location.protocol+"//"+location.host;a.defaultInjector=function(b,c,f,e){a.logIfDebug("Injecting into Frame ["+b.src+"]");try{if(b.id==b.name&&d.test(b.id))a.logIfDebug("Blacklisted iframe: "+b.src);else if(b.src&&("about:blank"!=b.src&&0>b.src.indexOf("javascript:"))&&b.src!=b.contentWindow.location.href)a.logIfDebug("Frame not yet loaded: "+b.src);else if(b.contentWindow[a.Namespace(b.contentWindow)])a.logIfDebug("FS already defined in Frame contentWindow: "+
b.src+". Ignoring.");else{var g=b.contentWindow,m=b.contentDocument;g._fs_org=c;g._fs_host=f;g._fs_debug=a.isDebug();g._fs_run_in_iframe=!0;var p=m.createElement("script");p.async=!0;p.src=e+"//"+f+"/s/fs.js";m.head.appendChild(p)}}catch(s){a.logIfDebug("iFrame no injecty. Probably not same origin.")}};var d=/^fb\d{18}$/,c;(function(a){a[a.NoInfoYet=1]="NoInfoYet";a[a.Enabled=2]="Enabled";a[a.Disabled=3]="Disabled"})(c=a.GetCurrentSessionEnabledState||(a.GetCurrentSessionEnabledState={}));var f=function(){function b(d,
f,e,g){var k=this;this._ctx=d;this._injector=g;this._iFrames=[];this._pendingChildFrameIdInits=[];this._listeners=new a.DomListeners;this._getCurrentSessionEnabled=c.NoInfoYet;this._blocker=new a.Blocker;this._transport=e(d,function(){k.shutdown()});this._queue=new a.EventQueue(d,this._transport,function(){return k._eventWatcher.bundleEvents()},f);this._eventWatcher=new a.EventWatcher(d,this._queue,this._blocker,function(a){k.onFrameCreated(a)});this._consoleWatcher=new a.ConsoleWatcher(this._queue,
d.getWindow());this._protocol=d.getProtocol();this._host=d.getHost();this._orgId=d.getOrgId();this._identity=d.getIdentity();this._wnd=d.getWindow()}b.prototype.start=function(b,c){var d=this;this._onFullyStarted=c;this._blocker.addPredicateRule({Selector:function(b){return"object"!=a.tagName(b)?!1:!(y.IMAGE_FILENAME.test(b.data)&&(void 0===b.type||0==b.type.lastIndexOf("image",0)))},Kind:a.NYI_KIND});this._blocker.addRule({Selector:"embed",Kind:a.NYI_KIND});this._blocker.addRule({Selector:"canvas",
Kind:a.NYI_KIND});this._blocker.addRule({Selector:"noscript",Kind:a.BLOCKED_KIND});this._blocker.addRule({Selector:".fs-hide",Kind:a.HIDE_KIND});this._consoleWatcher.enable();"onpagehide"in this._wnd?this._listeners.add(this._wnd,"pagehide",!1,function(a){d._queue.addUnload()}):this._listeners.add(this._wnd,"unload",!1,function(a){d._queue.addUnload()});this._listeners.add(this._wnd,"message",!1,function(a){"string"==typeof a.data&&d.postMessageReceived(a.source,g(a.data))})};b.prototype.getCurrentSessionEnabled=
function(){return this._getCurrentSessionEnabled};b.prototype.queue=function(){return this._queue};b.prototype.eventWatcher=function(){return this._eventWatcher};b.prototype.console=function(){return this._consoleWatcher};b.prototype.onDomLoad=function(){this._eventWatcher.onDomLoad()};b.prototype.onLoad=function(){this._eventWatcher.onLoad()};b.prototype.shutdown=function(){this._queue.shutdown();this._eventWatcher.shutdown();this._consoleWatcher.disable();this._listeners.clear();this.tellAllFramesTo([a.FS_SHUTDOWN_FRAME])};
b.prototype.tellAllFramesTo=function(b){for(var c=0;c<this._iFrames.length;c++){var d=this._iFrames[c].contentWindow;d&&d.postMessage&&d.postMessage(a.stringify({__fs:b}),"*")}};b.prototype.fullyStarted=function(){this._onFullyStarted()};b.prototype.flushPendingChildFrameInits=function(){if(0<this._pendingChildFrameIdInits.length){for(var a=0;a<this._pendingChildFrameIdInits.length;a++)this._pendingChildFrameIdInits[a]();this._pendingChildFrameIdInits=[]}};b.prototype.onFrameCreated=function(b){var c=
this,d=a.fsid(b);d?(this._iFrames.push(b),e(b)?(a.logIfDebug("Attempting to setup Frame ["+b.src+"]"),this._injector(b,this._orgId,this._host,this._protocol),b.addEventListener("load",function(d){a.logIfDebug("onload for frame ["+b.src+"]");c._injector(b,c._orgId,c._host,c._protocol)})):(a.logIfDebug("Frame Doesn't need injecting. Probably cross domain ["+b.src+"]"),b.contentWindow.postMessage&&(a.logIfDebug("Eagerly sending FrameId "+d+" to Frame ["+b.src+"]"),this.sendFrameIdToInnerFrame(b.contentWindow,
d)))):a.logIfDebug("fsid missing or invalid for iFrame."+b.src)};b.prototype.postMessageReceived=function(b,c){switch(c[0]){case a.FS_IFRAME_EVENTS:var d=c[1];0<d.length&&this._transport.enqueueEvents(d);break;case a.FS_REQUEST_FRAME_ID:d=this.iFrameWndToFsId(b),b&&d?(a.logIfDebug("Responding to FID request for frame "+d),this.sendFrameIdToInnerFrame(b,d)):a.logIfDebug("No FrameId found. Hoping to send one later.")}};b.prototype.sendFrameIdToInnerFrame=function(b,c){var d=this,f=function(){var f=
[];0!=d._frameId&&(f=d._parentIds?d._parentIds.concat(d._frameId):[d._frameId]);f=[a.FS_SET_FRAME_ID_CMD,c,f,d._ctx.startTime(),d._blocker.rawRules,d._identity.cookieData(),d._pageId,d.getCurrentSessionEnabled()];b&&b.postMessage&&b.postMessage(a.stringify({__fs:f}),"*")};null==this._frameId?this._pendingChildFrameIdInits.push(f):f()};b.prototype.iFrameWndToFsId=function(b){for(var c=0;c<this._iFrames.length;c++)if(this._iFrames[c].contentWindow==b)return a.fsid(this._iFrames[c]);a.logIfDebug("Unable to locate frame for window");
return NaN};return b}();a.AbstractRecorder=f;a.parsePostMessageData=g})(m||(m={}));(function(a){function g(b,d){return new a.HttpEventTransport(b,d)}var e=function(b){function d(c,d,e,h,m){void 0===d&&(d=a.RealTicker);void 0===e&&(e=new a.XHRPoster);void 0===h&&(h=g);void 0===m&&(m=a.defaultInjector);var l=b.call(this,c,d,h,m)||this;l._poster=e;l._domLoaded=!1;l._doc=l._wnd.document;l._frameId=0;l._getCurrentSessionEnabled=a.GetCurrentSessionEnabledState.NoInfoYet;a.set_fs_shutdown(l._wnd,function(a){l._queue.shutdown();
a&&(a=l._doc.getElementById(a))&&a.setAttribute("_fs_embed_token",l._embedToken)});return l}z(d,b);d.prototype.onDomLoad=function(){b.prototype.onDomLoad.call(this);this._domLoaded=!0;this.injectIntegrationScript()};d.prototype.start=function(c,d){var e=this;b.prototype.start.call(this,c,d);var g=this._doc.documentElement,m=a._fs_replay_flags(this._wnd),l=a.tryGetScreenDims(this._wnd),n=l[0],l=l[1],r="";c||(r=this._identity.userId());g={OrgId:this._identity.orgId(),UserId:r,Url:location.href,Base:a.baseUri(this._doc),
Width:g.clientWidth,Height:g.clientHeight,ScreenWidth:n,ScreenHeight:l,Referrer:this._doc.referrer,Doctype:a.doctypeString(this._doc),CompiledTimestamp:a.CompiledTimestamp};m&&(g.ReplayFlags=m);this._poster.post(this._protocol,this._host,"/rec/page",a.stringify(g),function(b){var c;try{c=a.parseJson(b)}catch(d){e.disableBecauseRecPageSaidSo();return}e.handleResponse(c);if(b=a._fs_ready(e._wnd))try{b()}catch(f){a.logIfDebug("exception in _fs_ready(): "+f)}for(b=0;b<c.Blocks.length;++b)try{a.BlockRule.isComment(c.Blocks[b].Selector)||
e._blocker.addRule(c.Blocks[b])}catch(g){a.logIfDebug("Unexpected error parsing block rule. Skipping "+c.Blocks[b])}e._queue.enqueueFirst(a.EVENT_SET_FRAME_BASE,[a.baseUri(e._doc),a.doctypeString(e._doc)]);e._queue.startPipeline(c.PageIntId);e.fullyStarted()},function(a){e.disableBecauseRecPageSaidSo()})};d.prototype.setIdsAndCookie=function(b){var d=this._identity;d.setIds(this._wnd,b.CookieDomain,b.UserIntId,b.SessionIntId);this._pageId=b.PageIntId;this._embedToken=b.EmbedToken;a.logIfDebug("/User,"+
d.userId()+"/Session,"+d.sessionId()+"/Page,"+b.PageIntId)};d.prototype.injectIntegrationScript=function(){if(this._domLoaded&&this._integrationScript){var b=this._doc.createElement("script");a._fs_csp(this._wnd)?b.src=this._protocol+this._host+"/rec/integrations?OrgId="+this._orgId:b.text=this._integrationScript;b.async=!0;this._doc.head.appendChild(b)}};d.prototype.handleResponse=function(b){this.setIdsAndCookie(b);this._integrationScript=b.IntegrationScript;this._getCurrentSessionEnabled=b.GetCurrentSessionEnabled?
a.GetCurrentSessionEnabledState.Enabled:a.GetCurrentSessionEnabledState.Disabled;this.injectIntegrationScript()};d.prototype.disableBecauseRecPageSaidSo=function(){this.shutdown();a.logIfDebug("Disabling FS.");var b=a._fs_ready(this._wnd);if(b)try{b(!0)}catch(d){a.logIfDebug("exception in _fs_ready(): "+d)}};return d}(a.AbstractRecorder);a.TopRecorder=e})(m||(m={}));(function(a){function g(b,d){return new a.PostMessageEventTransport(b.getWindow())}a.makeFrameTransport=g;var e=function(b){function d(c,
d,e,h,m){void 0===d&&(d=a.RealTicker);void 0===e&&(e=new a.PostMessagePoster);void 0===h&&(h=g);void 0===m&&(m=a.defaultInjector);c=b.call(this,c,d,h,m)||this;c._messagePoster=e;return c}z(d,b);d.prototype.start=function(a,d){b.prototype.start.call(this,a,d);this.sendRequestForFrameId()};d.prototype.postMessageReceived=function(c,d){b.prototype.postMessageReceived.call(this,c,d);switch(d[0]){case a.FS_SET_FRAME_ID_CMD:try{this.setFrameIdFromOutside(d[1],d[2],d[3],d[4],d[5],d[6],d[7])}catch(e){a.logIfDebug("Failed to parse frameId from message"+
d)}}};d.prototype.sendRequestForFrameId=function(){this._frameId||(0==this._frameId?a.logIfDebug("For some reason the outer window attempted to request a frameId"):(a.logIfDebug("Asking for a frame ID from within frame: "+location.href),this._messagePoster.postMessage(this._wnd.parent,a.FS_REQUEST_FRAME_ID,null)))};d.prototype.setFrameIdFromOutside=function(b,d,e,g,m,l,n){if(b)if(this._frameId)a.logIfDebug("frame Id is already set to "+this._frameId+". Received second request to set it to "+b+" Iframe:"+
location.href);else{a.logIfDebug("FrameId received within frame "+location.href+": "+b);this._identity.initFromParsedCookie(m);this._getCurrentSessionEnabled=n||a.GetCurrentSessionEnabledState.NoInfoYet;this._frameId=b;this._parentIds=d;for(m=0;m<g.length;++m)this._blocker.addRule(g[m]);this._queue.enqueueFirst(a.EVENT_SET_FRAME_BASE,[a.baseUri(this._wnd.document),a.doctypeString(this._wnd.document)]);this._queue.rebaseIframe(e);this._ctx.setStartTime(e);this._pageId=l;this._queue.startPipeline(l,
b,d);this.flushPendingChildFrameInits();this.fullyStarted()}else a.logIfDebug("Outer page gave us a bogus frame Id! Iframe: "+location.href)};return d}(a.AbstractRecorder);a.InnerRecorder=e})(m||(m={}));(function(a){var g=function(){function b(){}b.prototype.createTopRecorder=function(b){return new a.TopRecorder(b)};b.prototype.createInnerRecorder=function(b){return new a.InnerRecorder(b)};return b}();a.DefaultRecorderMaker=g;var e=function(){function b(a,b){void 0===a&&(a=window);void 0===b&&(b=
new g);this.wnd=a;this.recMaker=b;this.protocol="https:";this.domDoneLoaded=!1;this._startTime=this.wallTime();this.splitPending=this.waitingOnStart=this.gotWindowScroll=!1;this.reidentifyCount=0}b.prototype.init=function(){a.isLoaded(this.wnd)||(a.initWindex(this.wnd),a.setLoaded(this.wnd,a.Namespace(this.wnd)),this.initApi(),this.start())};b.prototype.wallTime=function(){return(new Date).getTime()};b.prototype.now=function(){return this.wallTime()-this._startTime};b.prototype.startTime=function(){return this._startTime};
b.prototype.setStartTime=function(a){this._startTime=a};b.prototype.maybeAddInitialScroll=function(){!this.gotWindowScroll&&(document.body&&a.fsid(document.body))&&(this.recorder.eventWatcher().addWindowScroll(),this.gotWindowScroll=!0)};b.prototype.getHost=function(){return this.host};b.prototype.getProtocol=function(){return this.protocol};b.prototype.getOrgId=function(){return this.orgId};b.prototype.getIdentity=function(){return this.identity};b.prototype.getVars=function(){return this.vars};
b.prototype.getWindow=function(){return this.wnd};b.prototype.getCurrentSessionURL=function(b){var c=this.recorder.getCurrentSessionEnabled();if(c==a.GetCurrentSessionEnabledState.NoInfoYet)return null;var e;e=this.identity.host();e=a.isLocalhost(a.domainFromHost(e))?e:0==e.indexOf("www.")?"app."+e.slice(4):"app."+e;if(c==a.GetCurrentSessionEnabledState.Disabled)return this.protocol+"//"+e+"/opt/upgrade";c=this.getCurrentSession();if(!c)return null;b&&(c+=":"+this.wallTime());return this.protocol+
"//"+e+"/ui/"+this.identity.orgId()+"/session/"+encodeURIComponent(c)};b.prototype.getCurrentSession=function(){var b=this.recorder.getCurrentSessionEnabled();return b!=a.GetCurrentSessionEnabledState.NoInfoYet&&b!=a.GetCurrentSessionEnabledState.Disabled&&this.identity.userId()?this.identity.userId()+":"+this.identity.sessionId():null};b.prototype.enableConsole=function(){this.recorder.console().enable()};b.prototype.disableConsole=function(){this.recorder.console().disable()};b.prototype.log=function(a){for(var b=
[],e=1;e<arguments.length;e++)b[e-1]=arguments[e];"log"!==a&&("info"!==a&&"warn"!==a&&"error"!==a&&"debug"!==a)&&(b.unshift(a),a="log");this.recorder.console().addLog(a,b)};b.prototype.shutdown=function(){this.recorder?(this.recorder.shutdown(),this.recorder=null):a.logIfDebug("Recording already shut down.")};b.prototype.restart=function(){this.recorder?a.logIfDebug("Recording already started."):this.createRecorder(!0)};b.prototype.splitPage=function(a){this.waitingOnStart?this.splitPending=!0:(this.shutdown(),
a&&this.identity.clear(),this.restart())};b.prototype._api=function(b,c){if(this.inFrame)a.logIfDebug("API calls may only be made from the top-most frame");else if(this.recorder){var e=this.vars.api(b,c),g=e[0];if(e[1]){if(8>this.reidentifyCount){this.reidentifyCount++;a.FS_q_push(this.wnd,[b,c]);this.splitPage(!0);return}a.logIfDebug("reidentified too many times; giving up")}for(e=0;e<g.length;e++)this.recorder.queue().enqueue(g[e].Kind,g[e].Args)}else a.FS_q_push(this.wnd,[b,c])};b.prototype._cookies=
function(){return this.identity.cookies()};b.prototype._setCookie=function(a,b){return this.identity.setCookie(a,b)};b.prototype.initApi=function(){var b=this.wnd[a.Namespace(this.wnd)];b.getCurrentSessionURL=a.$entry(this.getCurrentSessionURL,this);b.getCurrentSession=a.$entry(this.getCurrentSession,this);b.enableConsole=a.$entry(this.enableConsole,this);b.disableConsole=a.$entry(this.disableConsole,this);b.log=a.$entry(this.log,this);b.shutdown=a.$entry(this.shutdown,this);b.restart=a.$entry(this.restart,
this);b._api=a.$entry(this._api,this);b._cookies=a.$entry(this._cookies,this);b._setCookie=a.$entry(this._setCookie,this)};b.prototype.start=function(){var b=this;a.initDebug(this.wnd);a.logIfDebug("script version "+a.CompiledVersion+" (compiled at "+a.CompiledTimestamp+")");this.host=a._fs_host(this.wnd);this.orgId=a._fs_org(this.wnd);this.host?this.orgId?(a.logIfDebug("host: "+this.host),a.logIfDebug("orgid: "+this.orgId),"localhost:8080"==this.host&&(this.protocol="http:"),this.identity=new a.Identity,
this.inFrame||(this.vars=new a.Vars(this.identity),this.identity.initFromCookies(this.host,this.orgId)),this.canRecord(this.orgId)?(this.createRecorder(),this.hookLoadEvents(),this.wnd.addEventListener("message",function(c){if("string"==typeof c.data)switch(a.parsePostMessageData(c.data)[0]){case a.FS_SHUTDOWN_FRAME:b.shutdown();break;case a.FS_RESTART_FRAME:b.restart()}})):this.hailMary()):a.logIfDebug("Missing global _fs_org. Recording disabled."):a.logIfDebug("Missing global _fs_host. Recording disabled.")};
b.prototype.createRecorder=function(b){var c=this;this._startTime=this.wallTime();if(this.inFrame)this.recorder=this.recMaker.createInnerRecorder(this);else{this.recorder=this.recMaker.createTopRecorder(this);for(var e=this.drainApiQueue(a.FS_q_drain(this.wnd)),g=e[0],e=e[1],h=0;h<g.length;h++)this.recorder.queue().enqueue(g[h].Kind,g[h].Args)}this.waitingOnStart=!0;this.recorder.start(e,function(){c.waitingOnStart=!1;b&&c.recorder.tellAllFramesTo([a.FS_RESTART_FRAME]);c.splitPending&&(c.splitPending=
!1,c.splitPage())});b&&(this.recorder.onDomLoad(),this.recorder.onLoad())};b.prototype.drainApiQueue=function(a){if(a){for(var b,e=[],g=0;g<a.length;g++){var h;b=this.vars.api(a[g][0],a[g][1]);h=b[0];(b=b[1])&&(e=[]);e=e.concat(h)}return[e,b]}};b.prototype.determineFrameness=function(b){var c=a._fs_transport(this.wnd);a._fs_is_outer_script(this.wnd)?this.inFrame=!1:this.wnd!=top?this.inFrame=!0:c?c.init&&c.init(b)&&(this.inFrame=!0):this.inFrame=!1};b.prototype.canRecord=function(b){this.determineFrameness(b);
return this.wnd.MutationEvent&&this.wnd.postMessage?!this.inFrame||a._fs_run_in_iframe(this.wnd)||a._fs_transport(this.wnd)?!0:(a.logIfDebug("Fullstory recording for this page is NOT allowed within an iFrame."),!1):(a.logIfDebug("missing required browser features"),!1)};b.prototype.hailMary=function(){var b=this,c=document.documentElement,e=a._fs_replay_flags(this.wnd);a.logIfDebug("Unable to record playback stream.");var g=document.createElement("script");this.wnd.__fs_startResponse=function(a){a&&
b.identity.setIds(b.wnd,a.CookieDomain,a.UserIntId,a.SessionIntId);document.body.removeChild(g)};g.src="//"+this.host+"/rec/page?OrgId="+this.orgId+"&UserId="+this.identity.userId()+"&Url="+encodeURIComponent(location.href)+"&Base="+encodeURIComponent(a.baseUri(document))+"&Width="+c.clientWidth+"&Height="+c.clientHeight+"&ScreenWidth="+this.wnd.screen.width+"&ScreenHeight="+this.wnd.screen.height+"&Referrer="+encodeURIComponent(document.referrer)+"&Doctype="+encodeURIComponent(a.doctypeString(document))+
"&CompiledTimestamp="+a.CompiledTimestamp+"&Fallback=true"+(e?"&ReplayFlags="+e:"");document.body.appendChild(g)};b.prototype.hookLoadEvents=function(){var b=this,c=function(){b.domDoneLoaded||(b.domDoneLoaded=!0,a.initWindex(b.wnd),b.recorder.onDomLoad())},e=!1,g=function(){e||(e=!0,b.recorder.onLoad())};switch(document.readyState){case "interactive":document.attachEvent||c();break;case "complete":c(),g()}this.domDoneLoaded||document.addEventListener("DOMContentLoaded",function(a){c()});e||this.wnd.addEventListener("load",
function(a){c();g()})};return b}();a.GlobalContext=e})(m||(m={}));try{(new m.GlobalContext).init()}catch(B){m.sendToBugsnag(B,"error"),m._fs_debug(window)&&window.console&&console.log&&console.log("Failed to initialize FullStory.")}})();